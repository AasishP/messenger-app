{"version":3,"sources":["../node_modules/peerjs/dist sync","backendConfig.js","api/index.js","components/LoginPage/InputFields.jsx","components/Utils/Alert.jsx","components/LoginPage/LoginForm.jsx","components/LoginPage/SignUpForm.jsx","assets/loginPageBackground.svg","components/ProtectedRoute/authenticateUser.js","components/LoginPage/index.jsx","context/SocketContext.js","components/MessengerPage/SideNavigation/Conversation.jsx","components/MessengerPage/ChatSection/Header.jsx","components/MessengerPage/ChatSection/MediaContent.jsx","components/MessengerPage/ChatSection/Message.jsx","context/LoggedInUserContext.js","components/MessengerPage/ChatSection/MessageInput.jsx","assets/videoIconOverlay.png","components/MessengerPage/ChatSection/TypingIndicator.jsx","components/MessengerPage/ChatSection/MessagesContainer.jsx","components/MessengerPage/ChatSection/index.jsx","components/MessengerPage/SideNavigation/LogoutButton.jsx","components/MessengerPage/SideNavigation/UserWithAvatar.jsx","components/MessengerPage/SideNavigation/People.jsx","components/MessengerPage/SideNavigation/FriendList.jsx","components/MessengerPage/SideNavigation/FindFriends/FriendRequests.jsx","components/MessengerPage/SideNavigation/FindFriends/PendingFriendRequests.jsx","components/MessengerPage/SideNavigation/FindFriends/PeopleYouMayKnow.jsx","components/MessengerPage/SideNavigation/FindFriends/index.jsx","components/MessengerPage/SideNavigation/ConversationsContainer.jsx","components/MessengerPage/SideNavigation/SelectionMenu.jsx","components/MessengerPage/SideNavigation/SearchBox/SearchResults.jsx","components/MessengerPage/SideNavigation/SearchBox/index.jsx","components/MessengerPage/SideNavigation/index.jsx","components/MessengerPage/ChangeProfilePicture.jsx","components/MessengerPage/CallSection/CallTimer.jsx","components/MessengerPage/CallSection/useCallSounds.js","assets/sounds/connecting.mp3","assets/sounds/connected.mp3","assets/sounds/calling.mp3","assets/sounds/callFailed.mp3","assets/sounds/ringing.mp3","assets/sounds/reconnecting.mp3","assets/sounds/connectionLost.mp3","assets/sounds/hangup.mp3","components/MessengerPage/CallSection/CallAlert.jsx","components/MessengerPage/CallSection/ActionButtons.jsx","components/MessengerPage/CallSection/VideoCallHeader.jsx","components/MessengerPage/CallSection/VideoContainer.jsx","components/MessengerPage/CallSection/VideoCallScreen.jsx","components/MessengerPage/CallSection/index.jsx","components/MessengerPage/index.jsx","components/ProtectedRoute/index.jsx","App.js","index.js"],"names":["webpackEmptyContext","req","e","Error","code","keys","resolve","module","exports","id","config","address","wsAddress","baseURL","axiosInstance","axios","create","headers","interceptors","request","use","url","includes","data","localStorage","getItem","useStyles","makeStyles","form","width","maxWidth","minWidth","formTitle","margin","btn","padding","textTransform","link","textDecoration","alignSelf","divider","height","marginBottom","spinner","position","right","StyledTextField","withStyles","root","TextField","Form","formik","children","classes","onSubmit","handleSubmit","className","Box","display","flexDirection","alignItems","p","bgcolor","boxShadow","borderRadius","FormHeading","Typography","variant","color","align","InputField","name","inputProps","fullWidth","placeholder","aria-label","getFieldProps","error","Boolean","touched","errors","helperText","PasswordField","passwordVisible","setPasswordVisible","type","password","InputProps","endAdornment","InputAdornment","IconButton","onClick","Visibility","VisibilityOff","SubmitButton","loading","Button","CircularProgress","size","FormFooter","linkTo","linkText","Divider","light","to","component","Alert","theme","useTheme","useState","show","setShow","setTimeout","Slide","direction","in","timeout","enter","exit","top","marginRight","palette","main","CheckCircleOutline","htmlColor","InfoOutlined","WarningOutlined","ErrorOutlineOutlined","style","marginLeft","initialValues","username","values","a","setLoggedIn","setLoading","setFormError","post","res","status","window","setItem","accesstoken","state","message","response","validationSchema","yup","required","min","max","matches","trim","LoginForm","alert","formError","loggedIn","useFormik","autoFocus","FormHelperText","firstName","lastName","setRegistered","console","log","SignUpForm","registered","pathname","justifyContent","user","authenticateLoginToken","useStyle","background","backgroundImage","backgroundSize","backgroundPositionY","LoginPage","checked","setChecked","location","useLocation","useEffect","isValid","checkLoggedIn","path","SocketContext","createContext","StyledBadge","badge","border","backgroundColor","isonline","Badge","messageBadge","StyledButton","buttonRipple","primary","transform","props","ButtonBase","TouchRippleProps","MessageTime","msgTimestamp","formatMessageTimestamp","msgTime","setMsgTime","timestamp","moment","fromNow","replace","x","updateInterval","setInterval","clearInterval","fontSize","Conversation","lastMessage","conversationWith","history","useHistory","socket","useContext","userInfo","setUserInfo","online","setOnline","recentMessage","setRecentMessage","get","updateOnlineState","on","off","updateRecentMessage","msg","from","detail","recipient","listener","getUserInfo","document","addEventListener","removeEventListener","offMessageSend","push","overlap","badgeContent","anchorOrigin","vertical","horizontal","Avatar","alt","src","profilePic","px","seen","noWrap","fontWeight","text","media","images","length","videos","files","header","backdropFilter","zIndex","largeAvatar","buttonIcon","menu","marginTop","Header","anchorEl","setAnchorEl","handleMenuClose","callHandler","callType","call","CustomEvent","dispatchEvent","toUpperCase","mx","mt","ml","Phone","VideoCall","aria-controls","aria-haspopup","event","currentTarget","MoreVert","Menu","keepMounted","open","onClose","MenuItem","mediaContainer","flexWrap","progressBarContainer","CircularProgressWithLabel","progressPercent","setProgressPercent","updateProgress","progressEvent","msgtempid","msgTempId","amount","value","left","bottom","Image","image","srcURL","secure_url","URL","createObjectURL","revokeObjectURL","objectFit","flexGrow","maxHeight","Video","video","controls","File","file","fileContainer","fileName","default","fileIcon","Description","paper","href","download","MediaContent","isUploading","map","index","avatar","Message","prevMsgTimestamp","otherEndUser","setMessage","mediaMessageResponse","then","msgDirection","showTimestamp","day","halfHour","timeDifferenceBetweenMsg","diff","timeDifferenceFromNow","format","getColor","getContrastText","my","getBorderRadius","wordBreak","overflowWrap","wordWrap","LoggedInUserContext","selectedItemsContainer","overflowY","selectedMediasContainer","seperateImagesAndVideos","medias","split","links","this","tempMsgId","uuidv4","Date","useStyles_selectedMediaPreviewer","previewContainer","selectedImage","removeBtn","all","textAlign","videoContainer","content","backgroundPosition","SelectedMediasPreviewer","removeSelectedMedia","mediaObjectURL","Close","useStyles_selectedFilePreviewer","selectedFilePreviewContainer","SelectedFilesPreviewer","removeSelectedFile","MessageInput","updateMessages","Socket","loggedInUser","useParams","textFieldValue","setTextFieldValue","selectedImages","setSelectedImages","selectedVideos","setSelectedVideos","selectedFiles","setSelectedFiles","fileInputError","setFileInputError","typing","setTyping","dispatchSendMessage","sendMessage","dispatchUploadProgress","progress","uploadProgress","preventDefault","messageForClientSide","formData","FormData","append","forEach","onUploadProgress","Math","round","loaded","total","messageId","_id","recipientId","emit","target","removeSelectedImage","prevImages","splice","removeSelectedVideo","prevVideos","prevFiles","accept","multiple","onChange","htmlFor","ImageRounded","Attachment","Send","container","dot","animation","opacity","TypingIndicator","MessagesContainer","messageContainer","useRef","messages","setMessages","otherSide","prev","addMessage","current","scrollTo","scrollHeight","getMessages","removeAllListeners","ref","ChatSection","logoutText","LogoutButton","loggingOut","setLoggingOut","delete","LogoutType","clear","PowerSettingsNew","userAvatar","cursor","UserWithAvatar","setShowChangeProfilePicture","LoggedInUser","button","MutualFriendInformation","person","info","mutualFriends","grey","People","update","sendFriendRequest","acceptFriendRequest","rejectFriendRequest","cancelFriendRequest","unFriend","FriendUnFriendBtn","React","undefined","aria-describedby","Popover","transformOrigin","Done","blue","Clear","PersonAdd","getButton","FriendList","friendList","setFriendList","overflowX","FriendRequests","changed","friendRequests","setFriendRequests","Requester","PendingFriendRequests","pendingFriendRequests","setPendingFriendRequests","HourglassEmptyOutlined","Requested","PeopleYouMayKnow","peopleYouMayKnow","setPeopleYouMayKnow","EmojiPeople","Person","FindFriends","setChanged","random","getConversations","source","cancelToken","token","ConversationsContainer","conversations","setConversations","moveRecentConversationToTop","prevConversations","findIndex","conversation","with","recentConversation","axiosMain","CancelToken","cancel","tab","TabPanel","components","SelectionMenu","setIndex","Tabs","newIndex","indicatorColor","textColor","Tab","icon","Chat","GroupAdd","searchResultsContainer","SearchResults","searchText","searchResults","setSearchResults","cancelTokenSource","searchTerm","getSearchResults","results","isFriend","some","isRequestPending","hasSentFriendRequest","searchForm","paddingLeft","searchInput","outline","secondary","SearchBox","setSearchText","showSearchResults","setShowSearchResults","searchBoxRef","handleClickOutside","contains","tabIndex","onFocus","handleChange","Search","breakpoints","down","SideNavigation","borderRight","py","modal","modal__content","shadows","btnsContainer","greetingText","infoText","fullNameText","usernameText","ChangeProfilePicture","greeting","setLoggedInUser","profilePicture","setProfilePicture","setSelectedImage","setOpen","uploading","setUploading","setAlert","profilePicURL","handleClose","Modal","txtWhite","mb","reader","FileReader","readAsDataURL","result","endIcon","Publish","updateTimer","startTime","timeNow","timerHrs","getHours","timerMin","getMinutes","timerSec","sec","getSeconds","slice","CallTimer","callStartedTime","callState","timer","setTimer","CALLSTATES","HANGUP","CONNECTIONLOST","sounds","connecting","connected","calling","callFailed","ringing","reconnecting","connectionLost","hangup","useCallSounds","audio","Audio","load","loop","play","pause","call_alert","call_animation","webkitBackfaceVisibility","mozBackfaceVisibility","msBackfaceVisibility","backfaceVisibility","callerName","useButtonStyles","button_incoming","CallStatus","CALLFAILED","NOANSWER","BUSY","warning","getTextColor","noAnswer","busy","ongoing","MicButton","disabled","muted","setMuted","MicOff","Mic","RecallButton","callingUser","Call","success","AcceptCallButton","callAccepted","AudioCall","EndCallButton","callEnd","CallEnd","ActionButtons","CONNECTING","CONNECTED","CALLING","ONGOING","RECONNECTING","RINGING","CallAlert","remoteStream","localStream","alertRef","createRef","audioRef","getAudioTracks","track","enabled","srcObject","autoPlay","WebkitUserSelect","MozUserSelect","msUserSelect","userSelect","actionBtn","webkitBackdropFilter","cameraEnabled","setCameraEnabled","callEndRef","Event","Videocam","VideocamOff","videoCallHeader","userInfoContainer","headerBtn","wrapper","VideoCallHeader","fullScreen","setFullScreen","headerBtnsContainer","fullscreenElement","exitFullscreen","documentElement","requestFullscreen","FullscreenExit","Fullscreen","localVideoContainer","VideoContainer","localVideo","remoteVideo","VideoCallScreen","getVideoTracks","CALLDIRECTION","CALLTYPE","CallSection","setRemoteStream","setLocalStream","showVideoScreen","setShowVideoScreen","setCallState","setDirection","setCallType","setCallingUser","setCallStartedTime","showCallAlert","resetStates","handleCall","useCallback","callDirection","caller","peer","Peer","peerId","remotePeerId","receiver","ackCallType","navigator","mediaDevices","getUserMedia","stream","catch","err","answer","acceptCall","stopStreams","getTracks","tracks","stop","endCall","callFailTimeOut","noAnswerTimeOut","clearTimeout","busyUser","MessengerPage","io","auth","showChangeProfilePicture","notMediumScreen","useMediaQuery","disconnect","Provider","minHeight","newUser","exact","ProtectedRoute","setError","valid","createMuiTheme","xs","sm","md","lg","xl","App","ThemeProvider","ReactDOM","render","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.1c8feaa3.chunk.js","sourcesContent":["function webpackEmptyContext(req) {\n\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\te.code = 'MODULE_NOT_FOUND';\n\tthrow e;\n}\nwebpackEmptyContext.keys = function() { return []; };\nwebpackEmptyContext.resolve = webpackEmptyContext;\nmodule.exports = webpackEmptyContext;\nwebpackEmptyContext.id = 313;","const config = {\r\n  address: \"https://messenger-backend-server.herokuapp.com\",\r\n  wsAddress: \"wss://messenger-backend-server.herokuapp.com\",\r\n};\r\n\r\nexport default config;\r\n","import axios from \"axios\";\r\nimport config from \"../backendConfig\";\r\n\r\nconst baseURL = `${config.address}/api`;\r\n\r\nconst axiosInstance = axios.create({\r\n  baseURL,\r\n  headers: { \"X-Requested-With\": \"XMLHttpRequest\" },\r\n});\r\n\r\naxiosInstance.interceptors.request.use((request) => {\r\n  if (request.url.includes(\"/login\") && request.data) {\r\n    //this is the case if the login is performed with username and password which is contained in the request.data\r\n    return request;\r\n  }\r\n  if (!request.url.includes(\"/userinfo\")) {\r\n    request.headers[\"Authorization\"] = `Bearer ${localStorage.getItem(\r\n      \"accesstoken\"\r\n    )}`;\r\n  }\r\n  return request;\r\n});\r\n\r\nexport default axiosInstance;\r\n","import React from \"react\";\r\nimport { Link } from \"react-router-dom\";\r\nimport {\r\n  Box,\r\n  Button,\r\n  CircularProgress,\r\n  Divider,\r\n  IconButton,\r\n  InputAdornment,\r\n  makeStyles,\r\n  TextField,\r\n  Typography,\r\n  withStyles,\r\n} from \"@material-ui/core\";\r\nimport { Visibility, VisibilityOff } from \"@material-ui/icons\";\r\n\r\nconst useStyles = makeStyles({\r\n  form: {\r\n    width: \"70%\",\r\n    maxWidth: \"450px\",\r\n    minWidth: \"300px\",\r\n  },\r\n  formTitle: {\r\n    margin: \"0.5em\",\r\n  },\r\n  btn: {\r\n    width: \"fit-content\",\r\n    margin: \"1.5em 0\",\r\n    padding: \"0.7em 4em\",\r\n    textTransform: \"capitalize\",\r\n  },\r\n  link: {\r\n    textDecoration: \"none\",\r\n    alignSelf: \"flex-end\",\r\n  },\r\n  divider: {\r\n    width: \"100%\",\r\n    height: \"1.5px\",\r\n    marginBottom: \"1.5em\",\r\n  },\r\n  spinner: {\r\n    position: \"absolute\",\r\n    right: \"15%\",\r\n  },\r\n});\r\n\r\nconst StyledTextField = withStyles({\r\n  root: {\r\n    \"& .MuiInputBase-input\": {\r\n      padding: \"0.7em\",\r\n    },\r\n  },\r\n})(TextField);\r\n\r\nfunction Form({ formik, children }) {\r\n  const classes = useStyles();\r\n  return (\r\n    <form onSubmit={formik.handleSubmit} className={classes.form}>\r\n      <Box\r\n        display=\"flex\"\r\n        flexDirection=\"column\"\r\n        alignItems=\"center\"\r\n        p=\"2em 3em\"\r\n        bgcolor=\"white\"\r\n        boxShadow=\"rgb(37 117 252 / 20%) 0px 2px 20px 0px\"\r\n        borderRadius={10}\r\n      >\r\n        {children}\r\n      </Box>\r\n    </form>\r\n  );\r\n}\r\n\r\nfunction FormHeading({ children }) {\r\n  const classes = useStyles();\r\n  return (\r\n    <Typography\r\n      className={classes.formTitle}\r\n      variant=\"h5\"\r\n      color=\"primary\"\r\n      align=\"center\"\r\n    >\r\n      {children}\r\n    </Typography>\r\n  );\r\n}\r\n\r\nfunction InputField({ formik, name, ...inputProps }) {\r\n  return (\r\n    <StyledTextField\r\n      inputProps={inputProps}\r\n      variant=\"outlined\"\r\n      fullWidth\r\n      margin=\"normal\"\r\n      name={name}\r\n      placeholder={name}\r\n      aria-label={name}\r\n      {...formik.getFieldProps(name)}\r\n      error={Boolean(formik.touched[name] && formik.errors[name])}\r\n      helperText={formik.touched[name] ? formik.errors[name] : \"\"}\r\n    />\r\n  );\r\n}\r\n\r\nfunction PasswordField({\r\n  formik,\r\n  passwordVisible,\r\n  setPasswordVisible,\r\n  ...inputProps\r\n}) {\r\n  return (\r\n    <StyledTextField\r\n      inputProps={inputProps}\r\n      variant=\"outlined\"\r\n      fullWidth\r\n      margin=\"normal\"\r\n      type={passwordVisible ? \"text\" : \"password\"}\r\n      name=\"password\"\r\n      placeholder=\"Password\"\r\n      aria-label=\"password\"\r\n      {...formik.getFieldProps(\"password\")}\r\n      error={Boolean(formik.touched.password && formik.errors.password)}\r\n      helperText={formik.touched.password ? formik.errors.password : \"\"}\r\n      InputProps={{\r\n        endAdornment: (\r\n          <InputAdornment>\r\n            <IconButton onClick={() => setPasswordVisible(!passwordVisible)}>\r\n              {passwordVisible ? (\r\n                <Visibility color=\"primary\" />\r\n              ) : (\r\n                <VisibilityOff color=\"primary\" />\r\n              )}\r\n            </IconButton>\r\n          </InputAdornment>\r\n        ),\r\n      }}\r\n    />\r\n  );\r\n}\r\n\r\nfunction SubmitButton({ children, formik, loading }) {\r\n  const classes = useStyles();\r\n  return (\r\n    <Button\r\n      type=\"submit\"\r\n      className={classes.btn}\r\n      variant=\"contained\"\r\n      color=\"primary\"\r\n      aria-label=\"login button\"\r\n    >\r\n      {children}\r\n      {loading ? (\r\n        <CircularProgress\r\n          className={classes.spinner}\r\n          color=\"inherit\"\r\n          size=\"1.5em\"\r\n        />\r\n      ) : null}\r\n    </Button>\r\n  );\r\n}\r\n\r\nfunction FormFooter({ linkTo, children, linkText }) {\r\n  const classes = useStyles();\r\n  return (\r\n    <>\r\n      <Divider variant=\"middle\" light={true} className={classes.divider} />\r\n      <Typography variant=\"body2\" color=\"textSecondary\">\r\n        {children}{\" \"}\r\n        <Link to={linkTo} className={classes.link}>\r\n          <Typography variant=\"inherit\" color=\"primary\" component=\"span\">\r\n            {linkText}\r\n          </Typography>{\" \"}\r\n        </Link>\r\n        here!\r\n      </Typography>\r\n    </>\r\n  );\r\n}\r\n\r\nexport default StyledTextField;\r\nexport {\r\n  useStyles,\r\n  Form,\r\n  FormHeading,\r\n  InputField,\r\n  PasswordField,\r\n  SubmitButton,\r\n  FormFooter,\r\n};\r\n","import React, { useState } from \"react\";\r\nimport { Box, Slide, Typography, useTheme } from \"@material-ui/core\";\r\nimport {\r\n  CheckCircleOutline,\r\n  ErrorOutlineOutlined,\r\n  InfoOutlined,\r\n  WarningOutlined,\r\n} from \"@material-ui/icons\";\r\n\r\nfunction Alert({ type, children }) {\r\n  const theme = useTheme();\r\n  const [show, setShow] = useState(true);\r\n  setTimeout(() => {\r\n    setShow(false);\r\n  }, 2000);\r\n  return (\r\n    <Slide direction=\"down\" in={show} timeout={{ enter: 300, exit: 500 }}>\r\n      <Box\r\n        position=\"absolute\"\r\n        display=\"flex\"\r\n        top=\"5%\"\r\n        marginRight=\"auto\"\r\n        p=\"1em\"\r\n        borderRadius={5}\r\n        boxShadow={5}\r\n        bgcolor={theme.palette?.[type].main}\r\n      >\r\n        {type === \"success\" ? <CheckCircleOutline htmlColor=\"white\" /> : null}\r\n        {type === \"info\" ? <InfoOutlined htmlColor=\"white\" /> : null}\r\n        {type === \"warning\" ? <WarningOutlined htmlColor=\"white\" /> : null}\r\n        {type === \"error\" ? <ErrorOutlineOutlined htmlColor=\"white\" /> : null}\r\n\r\n        <Typography\r\n          variant=\"body1\"\r\n          style={{ marginLeft: \"0.5em\", color: \"white\" }}\r\n        >\r\n          {children}\r\n        </Typography>\r\n      </Box>\r\n    </Slide>\r\n  );\r\n}\r\n\r\nexport default Alert;\r\n","import { FormHelperText, Typography } from \"@material-ui/core\";\r\nimport axios from \"../../api\";\r\nimport React, { useState } from \"react\";\r\nimport { Link, Redirect } from \"react-router-dom\";\r\nimport {\r\n  Form,\r\n  FormFooter,\r\n  FormHeading,\r\n  InputField,\r\n  PasswordField,\r\n  SubmitButton,\r\n  useStyles,\r\n} from \"./InputFields\";\r\nimport Alert from \"../Utils/Alert\";\r\nimport { useFormik } from \"formik\";\r\nimport * as yup from \"yup\";\r\n\r\n//formik props set up\r\nconst initialValues = {\r\n  username: \"\",\r\n  password: \"\",\r\n};\r\n\r\n//form Submission\r\nconst onSubmit = async (values, { setLoggedIn, setLoading, setFormError }) => {\r\n  setLoading(true);\r\n  try {\r\n    const res = await axios.post(\"/login\", values);\r\n    if (res.status === 200) {\r\n      window.localStorage.setItem(\"accesstoken\", res.data.accesstoken);\r\n      setLoggedIn(true);\r\n    }\r\n  } catch (err) {\r\n    setLoading(false);\r\n    setFormError({ state: true, message: err.response?.data || err.message });\r\n  }\r\n};\r\n//input validationSchema\r\nconst validationSchema = yup.object({\r\n  username: yup\r\n    .string()\r\n    .required(\"username cannot be empty!\")\r\n    .min(4, \"username must be at least 4 characters!\")\r\n    .max(255, \"username cannot exceed 255 characters!\")\r\n    .matches(\r\n      /[A-Za-z0-9._]{4,255}$/,\r\n      \"Only albabets dot(.) and underscore(_) is allowed!\"\r\n    ),\r\n  password: yup\r\n    .string()\r\n    .trim()\r\n    .required(\"password cannot be empty!\")\r\n    .min(6, \"password must be least 6 characters long!\")\r\n    .max(255, \"password cannot exceed 255 characters!\")\r\n    .matches(\r\n      /[\\S]{6,255}$/,\r\n      \"password cannnot contain white space characters!\"\r\n    ),\r\n});\r\n\r\nfunction LoginForm({ alert }) {\r\n  const [formError, setFormError] = useState({\r\n    state: false,\r\n    message: \"\",\r\n  });\r\n  const [passwordVisible, setPasswordVisible] = useState(false);\r\n  const [loading, setLoading] = useState(false);\r\n  const [loggedIn, setLoggedIn] = useState(false);\r\n\r\n  const formik = useFormik({\r\n    initialValues,\r\n    onSubmit: (values) => {\r\n      onSubmit(values, { setLoggedIn, setLoading, setFormError });\r\n    },\r\n    validationSchema,\r\n  });\r\n  const classes = useStyles();\r\n\r\n  if (loggedIn) {\r\n    return <Redirect to=\"/messenger\" />;\r\n  }\r\n  return (\r\n    <>\r\n      {alert ? <Alert type={alert.type}>{alert.message}</Alert> : null}\r\n\r\n      <Form formik={formik}>\r\n        {/* This is custom Form component. It is defined in InputFields.jsx */}\r\n        <FormHeading>Welcome Back</FormHeading>\r\n\r\n        {/*Username Field*/}\r\n        <InputField name=\"username\" formik={formik} autoFocus />\r\n\r\n        {/*Password Field*/}\r\n        <PasswordField\r\n          formik={formik}\r\n          passwordVisible={passwordVisible}\r\n          setPasswordVisible={setPasswordVisible}\r\n        />\r\n        {/* error message  */}\r\n        <FormHelperText error={formError.state}>\r\n          {formError.message}\r\n        </FormHelperText>\r\n\r\n        {/*forget password*/}\r\n        <Link to=\"/\" className={classes.link}>\r\n          <Typography variant=\"subtitle1\" color=\"primary\">\r\n            Forget Password?\r\n          </Typography>\r\n        </Link>\r\n\r\n        {/* sign in button */}\r\n        <SubmitButton formik={formik} loading={loading}>\r\n          Sign In\r\n        </SubmitButton>\r\n\r\n        <FormFooter linkTo=\"/signup\" linkText=\"Sign Up\">\r\n          Don't have an account ?\r\n        </FormFooter>\r\n      </Form>\r\n    </>\r\n  );\r\n}\r\n\r\nexport default LoginForm;\r\n","import { Box, FormHelperText } from \"@material-ui/core\";\r\nimport { useFormik } from \"formik\";\r\nimport React, { useState } from \"react\";\r\nimport { Redirect } from \"react-router-dom\";\r\nimport * as yup from \"yup\";\r\nimport axios from \"../../api\";\r\nimport {\r\n  Form,\r\n  PasswordField,\r\n  SubmitButton,\r\n  InputField,\r\n  FormHeading,\r\n  FormFooter,\r\n} from \"./InputFields\";\r\n\r\n//formik setUp\r\nconst initialValues = {\r\n  firstName: \"\",\r\n  lastName: \"\",\r\n  username: \"\",\r\n  password: \"\",\r\n};\r\n//form Submission\r\nconst onSubmit = async (values,{ setRegistered,setLoading, setFormError}) => {\r\n  setLoading(true);\r\n  try {\r\n    const res = await axios.post(\"/register\", values);\r\n    if (res.status === 201) {\r\n      setRegistered(true);\r\n    }\r\n  } catch (err) {\r\n    console.log(err);\r\n    setFormError({ state: true, message: err.response?.data || err.message})\r\n    setLoading(false);\r\n  }\r\n};\r\n//input validationSchema\r\nconst validationSchema = yup.object({\r\n  firstName: yup\r\n    .string()\r\n    .required(\"firstName cannot be empty!\")\r\n    .min(3, \"firstName must be at least 3 characters!\")\r\n    .max(255, \"firstName cannot exceed 255 characters!\")\r\n    .matches(/[A-Za-z]{3,255}$/, \"Invalid Characters!, use letters only.\"),\r\n  lastName: yup\r\n    .string()\r\n    .required(\"lastName cannot be empty!\")\r\n    .min(3, \"lastName must be at least 3 characters!\")\r\n    .max(255, \"lastName cannot exceed 255 characters!\")\r\n    .matches(/[A-Za-z]{3,255}$/, \"Invalid Characters!, use letters only.\"),\r\n  username: yup\r\n    .string()\r\n    .required(\"username cannot be empty!\")\r\n    .min(4, \"username must be at least 4 characters!\")\r\n    .max(255, \"username cannot exceed 255 characters!\")\r\n    .matches(\r\n      /[A-Za-z0-9._]{4,255}$/,\r\n      \"Only albabets dot(.) and underscore(_) is allowed!\"\r\n    ),\r\n  password: yup\r\n    .string()\r\n    .trim()\r\n    .required(\"password cannot be empty!\")\r\n    .min(6, \"password must be least 6 characters long!\")\r\n    .max(255, \"password cannot exceed 255 characters!\")\r\n    .matches(\r\n      /[\\S]{6,255}$/,\r\n      \"password cannnot contain white space characters!\"\r\n    ),\r\n});\r\n\r\nfunction SignUpForm() {\r\n  const [passwordVisible, setPasswordVisible] = useState(false);\r\n  const [loading, setLoading] = useState(false);\r\n  const [formError, setFormError] = useState({\r\n    state: false,\r\n    message: \"\",\r\n  });\r\n  const [registered, setRegistered] = useState(false);\r\n\r\n  const formik = useFormik({\r\n    initialValues,\r\n    onSubmit: (values) => {\r\n      onSubmit(values,{setRegistered, setLoading, setFormError});\r\n    },\r\n    validationSchema,\r\n  });\r\n\r\n  if(registered){\r\n    return <Redirect to={{ pathname:\"/login\",state:{ alert:{type: 'success', message:\"User Succesfully Registered!\"}}}} />\r\n  }\r\n\r\n  return (\r\n    <Form formik={formik}>\r\n      <FormHeading>Lets Get Started.</FormHeading>\r\n\r\n      {/* This is for Firstname and lastName input field */}\r\n      <Box display=\"flex\" justifyContent=\"space-between\">\r\n        <InputField name=\"firstName\" formik={formik} />\r\n        <div style={{ width: \"1em\" }}></div>\r\n        <InputField name=\"lastName\" formik={formik} />\r\n      </Box>\r\n\r\n      {/* This is for username input field */}\r\n      <InputField name=\"username\" formik={formik} />\r\n      {/* This is for password Input Field */}\r\n      <PasswordField\r\n        passwordVisible={passwordVisible}\r\n        setPasswordVisible={setPasswordVisible}\r\n        formik={formik}\r\n      />\r\n\r\n      {/* error message  */}\r\n      <FormHelperText error={formError.state}>\r\n        {formError.message}\r\n      </FormHelperText>\r\n\r\n      <SubmitButton formik={formik} loading={loading}>\r\n        Sign Up\r\n      </SubmitButton>\r\n\r\n      <FormFooter linkTo=\"/login\" linkText=\"Sign In\">\r\n        Already have an account ?\r\n      </FormFooter>\r\n    </Form>\r\n  );\r\n}\r\n\r\nexport default SignUpForm;\r\n","export default __webpack_public_path__ + \"static/media/loginPageBackground.566fa2ff.svg\";","import axios from \"../../api\";\r\n\r\nasync function authenticateLoginToken() {\r\n  const accesstoken = window.localStorage.getItem(\"accesstoken\");\r\n  if (accesstoken) {\r\n      //making login request with AccessToken\r\n      const res = await axios.post(\"/login\");\r\n      if (res.status === 200) {\r\n        return {user: res.data}\r\n      }\r\n      //if authentication failed with error it can be catched by catch block.\r\n    }\r\n   else {\r\n    //if accesstoken is not present.\r\n    return false\r\n  }\r\n}\r\n\r\nexport default authenticateLoginToken;\r\n","import { Box, makeStyles } from \"@material-ui/core\";\r\nimport React, { useEffect, useState } from \"react\";\r\nimport { Route, Redirect, useLocation } from \"react-router-dom\";\r\nimport LoginForm from \"./LoginForm\";\r\nimport SignUpForm from \"./SignUpForm\";\r\nimport backgroundImage from \"../../assets/loginPageBackground.svg\";\r\nimport authenticateLoginToken from \"../ProtectedRoute/authenticateUser\";\r\n\r\nconst useStyle = makeStyles({\r\n  root: {\r\n    background: `url(${backgroundImage})`,\r\n    backgroundSize: \"cover\",\r\n    backgroundPositionY: \"100%\",\r\n  },\r\n});\r\n\r\nfunction LoginPage() {\r\n  const [loggedIn, setLoggedIn] = useState(false);\r\n  const [checked,setChecked] = useState(false);\r\n  const classes = useStyle();\r\n  const location = useLocation();\r\n\r\n  // check if the user is already logged in.\r\n  useEffect(() => {\r\n    async function checkLoggedIn() {\r\n      try{\r\n      const isValid = await authenticateLoginToken();\r\n      isValid && setLoggedIn(isValid);\r\n      setChecked(true);\r\n      } catch (err) {\r\n        location.state={alert:{ type: \"error\", message: err.response?.data || err.message }}\r\n        setChecked(true);\r\n      }\r\n    }\r\n    checkLoggedIn();\r\n  }, [location]);\r\n\r\n  if (loggedIn) {\r\n    return <Redirect to=\"/messenger\" />;\r\n  }\r\n  if(!checked){\r\n    return null\r\n  }\r\n  return (\r\n    <Box\r\n      className={classes.root}\r\n      display=\"flex\"\r\n      justifyContent=\"center\"\r\n      alignItems=\"center\"\r\n      height=\"100vh\"\r\n      width=\"100vw\"\r\n    >\r\n      <Route path=\"/\">\r\n        <Redirect\r\n          to={{\r\n            pathname: \"/login\",\r\n            state: location.state,\r\n          }}\r\n        />\r\n      </Route>\r\n      <Route path=\"/login\">\r\n        <LoginForm alert={location.state?.alert} />\r\n      </Route>\r\n      <Route path=\"/signup\">\r\n        <SignUpForm />\r\n      </Route>\r\n    </Box>\r\n  );\r\n}\r\n\r\nexport default LoginPage;\r\n","import { createContext } from \"react\";\r\n\r\nconst SocketContext=createContext();\r\n\r\nexport default SocketContext;","import {\r\n  Avatar,\r\n  Box,\r\n  Badge,\r\n  withStyles,\r\n  Typography,\r\n  ButtonBase,\r\n  makeStyles,\r\n} from \"@material-ui/core\";\r\nimport moment from \"moment\";\r\nimport React, { useContext, useEffect, useState } from \"react\";\r\nimport { useHistory } from \"react-router\";\r\nimport axios from \"../../../api\";\r\nimport SocketContext from \"../../../context/SocketContext\";\r\n\r\nexport const StyledBadge = withStyles(() => ({\r\n  badge: {\r\n    height: \"0.9em\",\r\n    width: \"0.9em\",\r\n    borderRadius: \"50%\",\r\n    border: `2px solid #fff`,\r\n    backgroundColor: ({ isonline }) => {\r\n      return isonline ? \"green\" : \"grey\";\r\n    },\r\n  },\r\n}))(Badge);\r\n\r\nconst useStyles = makeStyles({\r\n  messageBadge: {\r\n    marginLeft: \"1em\",\r\n  },\r\n});\r\n\r\nconst styles = (theme) => ({\r\n  buttonRipple: {\r\n    color: theme.palette.primary.main,\r\n  },\r\n  main: {\r\n    padding: \"1em\",\r\n    width: \"100%\",\r\n    justifyContent: \"start\",\r\n    \"&:hover\": {\r\n      transform: \"scale(1.01)\",\r\n      boxShadow: \"rgb(145 158 171 / 24%) 0px 5px 16px 0px\",\r\n    },\r\n  },\r\n});\r\n\r\nconst StyledButton = withStyles(styles)((props) => (\r\n  <ButtonBase\r\n    className={props.classes.main}\r\n    TouchRippleProps={{ classes: { root: props.classes.buttonRipple } }}\r\n    component=\"div\"\r\n    onClick={props.onClick}\r\n  >\r\n    {props.children}\r\n  </ButtonBase>\r\n));\r\n\r\nfunction MessageTime({ msgTimestamp }) {\r\n  //states\r\n  const [msgTime, setMsgTime] = useState(() => {\r\n    formatMessageTimestamp(msgTimestamp);\r\n  });\r\n\r\n  function formatMessageTimestamp(timestamp) {\r\n    return moment(timestamp)\r\n      .fromNow(true)\r\n      .replace(\r\n        /a few seconds| hours|a minute| minutes| days|an hour|a day/gi,\r\n        function (x) {\r\n          switch (x) {\r\n            case \" hours\":\r\n              return \"h\";\r\n            case \" minutes\":\r\n              return \"m\";\r\n            case \" days\":\r\n              return \"d\";\r\n            case \" months\":\r\n              return \"mth\";\r\n            case \"a few seconds\":\r\n              return \"Just Now\";\r\n            case \"a minute\":\r\n              return \"1m\";\r\n            case \"an hour\":\r\n              return \"1h\";\r\n            case \"a day\":\r\n              return \"1d\";\r\n            default:\r\n              return x;\r\n          }\r\n        }\r\n      );\r\n  }\r\n\r\n  useEffect(() => {\r\n    setMsgTime(formatMessageTimestamp(msgTimestamp)); //initial run\r\n    const updateInterval = setInterval(() => {\r\n      setMsgTime(formatMessageTimestamp(msgTimestamp));\r\n    }, 60000); //update every minutes\r\n    return () => {\r\n      clearInterval(updateInterval);\r\n    };\r\n  }, [msgTimestamp]);\r\n\r\n  return (\r\n    <Typography color=\"textSecondary\" style={{ fontSize: \"0.9rem\" }}>\r\n      {msgTime}\r\n    </Typography>\r\n  );\r\n}\r\n\r\nfunction Conversation({ lastMessage, conversationWith }) {\r\n  const classes = useStyles();\r\n  const history = useHistory();\r\n  //context\r\n  const socket = useContext(SocketContext);\r\n\r\n  //states\r\n  const [userInfo, setUserInfo] = useState({});\r\n  const [online, setOnline] = useState(false);\r\n  const [recentMessage, setRecentMessage] = useState(lastMessage);\r\n  //custom events\r\n\r\n  //add listener\r\n  function onMessageSend(listener) {\r\n    document.addEventListener(\"sendMessage\", listener);\r\n  }\r\n\r\n  //remove listener\r\n  function offMessageSend(listener) {\r\n    document.removeEventListener(\"sendMessage\", listener);\r\n  }\r\n\r\n  async function getUserInfo(username) {\r\n    const res = await axios.get(`/userinfo/${username}`);\r\n    setUserInfo(res.data);\r\n  }\r\n\r\n  //open messages\r\n  function openMessages() {\r\n    history.push(`/messenger/${conversationWith}`);\r\n  }\r\n\r\n  //useEffects\r\n\r\n  useEffect(() => {\r\n    //updateOnlineState\r\n    function updateOnlineState(username, state) {\r\n      username === userInfo?.username && setOnline(state);\r\n    }\r\n\r\n    socket.on(\"onlineStateChange\", updateOnlineState);\r\n    return () => {\r\n      socket.off(\"onlineStateChange\", updateOnlineState);\r\n    };\r\n  }, [socket, userInfo]);\r\n\r\n  useEffect(() => {\r\n    setOnline(userInfo.online);\r\n  }, [userInfo.online]);\r\n\r\n  useEffect(() => {\r\n    //updateRecentMessage\r\n    function updateRecentMessage(msg) {\r\n      msg.from === conversationWith && setRecentMessage(msg);\r\n\r\n      msg.detail?.recipient === conversationWith &&\r\n        setRecentMessage(msg.detail); //in this case msg is the custom event object which contains the detail property which is the info passed during the dispatch of the event.\r\n    }\r\n\r\n    getUserInfo(conversationWith);\r\n\r\n    socket.on(\"receive-message\", updateRecentMessage);\r\n    onMessageSend(updateRecentMessage);\r\n\r\n    return () => {\r\n      socket.off(\"receive-message\", updateRecentMessage);\r\n      offMessageSend(updateRecentMessage); //removeEventListener\r\n    };\r\n  }, [lastMessage, conversationWith, socket]);\r\n\r\n  return (\r\n    <StyledButton onClick={openMessages}>\r\n      <StyledBadge\r\n        isonline={online ? 1 : 0}\r\n        overlap=\"circle\"\r\n        badgeContent=\"\"\r\n        variant=\"dot\"\r\n        anchorOrigin={{ vertical: \"bottom\", horizontal: \"right\" }}\r\n      >\r\n        <Avatar alt={userInfo.username} src={userInfo.profilePic} />\r\n      </StyledBadge>\r\n\r\n      <Box px=\"0.8em\">\r\n        <Typography\r\n          color=\"textPrimary\"\r\n          variant=\"h6\"\r\n          style={{ fontSize: \"1.1rem\" }}\r\n        >\r\n          {userInfo.firstName} {userInfo.lastName}\r\n        </Typography>\r\n\r\n        <Typography\r\n          color={recentMessage.seen ? \"textSecondary\" : \"textPrimary\"}\r\n          component=\"p\"\r\n          noWrap\r\n          style={{\r\n            width: \"15.5rem\",\r\n            fontWeight: recentMessage.seen ? \"normal\" : \"bold\",\r\n          }}\r\n        >\r\n          {recentMessage.from === userInfo.username\r\n            ? `${userInfo.firstName}: `\r\n            : \"you: \"}\r\n\r\n          {/*message text */}\r\n          {recentMessage.text ||\r\n            ((recentMessage.media.images.length >0||\r\n              recentMessage.media.videos.length >0||\r\n              recentMessage.media.files.length>0) &&\r\n              \"sent an attatchment!\")}\r\n        </Typography>\r\n      </Box>\r\n\r\n      <Box marginLeft=\"auto\" display=\"flex\" alignItems=\"center\">\r\n        <MessageTime msgTimestamp={recentMessage.timestamp} />\r\n        <Badge className={classes.messageBadge} color=\"primary\" variant=\"dot\" />\r\n      </Box>\r\n    </StyledButton>\r\n  );\r\n}\r\n\r\nexport default Conversation;\r\n","import React, { useContext, useEffect } from \"react\";\r\nimport {\r\n  Avatar,\r\n  Box,\r\n  IconButton,\r\n  makeStyles,\r\n  Menu,\r\n  MenuItem,\r\n  Typography,\r\n} from \"@material-ui/core\";\r\nimport { StyledBadge } from \"../SideNavigation/Conversation\";\r\nimport { MoreVert, Phone, VideoCall } from \"@material-ui/icons\";\r\nimport { useState } from \"react\";\r\nimport SocketContext from \"../../../context/SocketContext\";\r\n\r\nconst useStyles = makeStyles({\r\n  header: {\r\n    position: \"absolute\",\r\n    backdropFilter: \"blur(5px)\",\r\n    backgroundColor: \"#ffffffc5\",\r\n    zIndex: \"10\",\r\n    width: \"100%\",\r\n    display: \"flex\",\r\n    alignItems: \"center\",\r\n    padding: \"1em 2em\",\r\n    borderRadius: \"0 0 5px 5px\",\r\n    boxShadow: \"rgb(145 158 171 / 24%) 0px 8px 16px 0px\",\r\n  },\r\n  largeAvatar: {\r\n    height: \"2.5em\",\r\n    width: \"2.5em\",\r\n  },\r\n  buttonIcon: {\r\n    margin: \"0 0.7em\",\r\n  },\r\n  menu: {\r\n    marginTop: \"3em\",\r\n  },\r\n});\r\n\r\nfunction Header({ userInfo }) {\r\n  const classes = useStyles();\r\n  //contexts\r\n  const socket = useContext(SocketContext);\r\n\r\n  //states\r\n  const [online, setOnline] = useState(userInfo.online);\r\n  const [anchorEl, setAnchorEl] = useState(null); //for menu\r\n\r\n  const handleMenuClose = () => {\r\n    setAnchorEl(null);\r\n  };\r\n\r\n  useEffect(() => {\r\n    //updateOnlineState\r\n    function updateOnlineState(username, state) {\r\n      console.log(\"informed\");\r\n      username === userInfo?.username && setOnline(state);\r\n    }\r\n\r\n    socket.on(\"onlineStateChange\", updateOnlineState);\r\n    return () => {\r\n      socket.off(\"onlineStateChange\", updateOnlineState);\r\n    };\r\n  }, [socket, userInfo]);\r\n\r\n  useEffect(() => {\r\n    setOnline(userInfo.online);\r\n  }, [userInfo.online]);\r\n\r\n  function callHandler(callType) {\r\n    const call = new CustomEvent(\"call\", { detail: { userInfo, callType } });\r\n    document.dispatchEvent(call);\r\n  }\r\n\r\n  return (\r\n    <Box className={classes.header}>\r\n      <StyledBadge\r\n        variant=\"dot\"\r\n        badgeContent=\" \"\r\n        overlap=\"circle\"\r\n        isonline={online ? 1 : 0}\r\n        anchorOrigin={{ vertical: \"bottom\", horizontal: \"right\" }}\r\n      >\r\n        <Avatar\r\n          className={classes.largeAvatar}\r\n          alt={userInfo.username?.toUpperCase()}\r\n          src={userInfo.profilePic}\r\n        />\r\n      </StyledBadge>\r\n      <Box mx=\"1em\">\r\n        <Box display=\"flex\" flexDirection=\"column\" justifyContent=\"center\">\r\n          <Typography variant=\"h6\" color=\"textPrimary\">\r\n            {userInfo.firstName} {userInfo.lastName}\r\n          </Typography>\r\n          <Typography variant=\"subtitle1\" color=\"textPrimary\">\r\n            {userInfo.username ? `@${userInfo.username}` : \"\"}\r\n          </Typography>\r\n        </Box>\r\n      </Box>\r\n\r\n      <Box mx=\"auto\" mt=\"auto\">\r\n        <Typography variant=\"subtitle1\" color=\"textSecondary\">\r\n          {online ? \"Active Now\" : \"Offline\"}\r\n        </Typography>\r\n      </Box>\r\n\r\n      <Box ml=\"auto\">\r\n        <IconButton\r\n          className={classes.buttonIcon}\r\n          onClick={() => {\r\n            callHandler(\"AudioCall\");\r\n          }}\r\n        >\r\n          <Phone fontSize=\"large\" color=\"primary\" />\r\n        </IconButton>\r\n        <IconButton\r\n          className={classes.buttonIcon}\r\n          onClick={() => {\r\n            callHandler(\"VideoCall\");\r\n          }}\r\n        >\r\n          <VideoCall fontSize=\"large\" color=\"primary\" />\r\n        </IconButton>\r\n\r\n        {/* menu btn */}\r\n        <IconButton\r\n          className={classes.buttonIcon}\r\n          aria-controls=\"header-menu\"\r\n          aria-haspopup=\"true\"\r\n          onClick={(event) => {\r\n            setAnchorEl(event.currentTarget);\r\n          }}\r\n        >\r\n          <MoreVert fontSize=\"large\" color=\"primary\" />\r\n        </IconButton>\r\n        <Menu\r\n          id=\"header-menu\"\r\n          className={classes.menu}\r\n          anchorEl={anchorEl}\r\n          keepMounted\r\n          open={Boolean(anchorEl)}\r\n          onClose={handleMenuClose}\r\n        >\r\n          <MenuItem onClick={handleMenuClose}>Profile</MenuItem>\r\n          <MenuItem onClick={handleMenuClose}>My account</MenuItem>\r\n          <MenuItem onClick={handleMenuClose}>Logout</MenuItem>\r\n        </Menu>\r\n      </Box>\r\n    </Box>\r\n  );\r\n}\r\n\r\nexport default Header;\r\n","import {\r\n  Box,\r\n  makeStyles,\r\n  Typography,\r\n  useTheme,\r\n  CircularProgress,\r\n} from \"@material-ui/core\";\r\nimport { Description } from \"@material-ui/icons\";\r\nimport React, { useEffect, useState } from \"react\";\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  mediaContainer: {\r\n    position: \"relative\",\r\n    display: \"flex\",\r\n    flexWrap: \"wrap\",\r\n  },\r\n  progressBarContainer: {\r\n    display: \"flex\",\r\n    alignItems: \"center\",\r\n    justifyContent: \"center\",\r\n    position: \"absolute\",\r\n    height: \"100%\",\r\n    width: \"100%\",\r\n    borderRadius: \"10px\",\r\n    background: \"#000000b1\",\r\n  },\r\n}));\r\n\r\nfunction CircularProgressWithLabel(props) {\r\n  const [progressPercent, setProgressPercent] = useState(0);\r\n\r\n  useEffect(() => {\r\n    function updateProgress(progressEvent) {\r\n      if (props.msgtempid === progressEvent.detail.msgTempId) {\r\n        setProgressPercent(progressEvent.detail.amount);\r\n      }\r\n    }\r\n    document.addEventListener(\"uploadProgress\", updateProgress);\r\n    return () => {\r\n      document.removeEventListener(\"uploadProgress\", updateProgress);\r\n    };\r\n  }, [props.msgtempid]);\r\n\r\n  return (\r\n    <Box position=\"relative\" display=\"inline-flex\">\r\n      <CircularProgress\r\n        value={progressPercent}\r\n        variant=\"determinate\"\r\n        {...props}\r\n      />\r\n      <Box\r\n        top={0}\r\n        left={0}\r\n        bottom={0}\r\n        right={0}\r\n        position=\"absolute\"\r\n        display=\"flex\"\r\n        alignItems=\"center\"\r\n        justifyContent=\"center\"\r\n      >\r\n        <Typography\r\n          variant=\"caption\"\r\n          component=\"div\"\r\n          style={{ color: \"white\", fontSize: \"1.3em\" }}\r\n        >{`${progressPercent}%`}</Typography>\r\n      </Box>\r\n    </Box>\r\n  );\r\n}\r\n\r\nfunction Image({ image }) {\r\n  const srcURL = image.secure_url || URL.createObjectURL(image);\r\n  useEffect(() => {\r\n    return () => {\r\n      URL.revokeObjectURL(srcURL);\r\n    };\r\n  }, [srcURL]);\r\n  return (\r\n    <img\r\n      style={{\r\n        objectFit: \"cover\",\r\n        margin: \"0.3em\",\r\n        width: \"calc(100%/3 - 10px)\",\r\n        flexGrow: \"1\",\r\n        maxHeight: \"100px\",\r\n        borderRadius: \"10px\",\r\n      }}\r\n      src={srcURL}\r\n      alt=\"msg-media\"\r\n    />\r\n  );\r\n}\r\n\r\nfunction Video({ video }) {\r\n  const srcURL = video.secure_url || URL.createObjectURL(video);\r\n  useEffect(() => {\r\n    return () => {\r\n      URL.revokeObjectURL(srcURL);\r\n    };\r\n  }, [srcURL]);\r\n  return (\r\n    <video\r\n      style={{\r\n        margin: \"0.3em\",\r\n        width: \"calc(100%/3 - 10px)\",\r\n        flexGrow: \"1\",\r\n        maxHeight: \"20vw\",\r\n        borderRadius: \"10px\",\r\n      }}\r\n      src={srcURL}\r\n      controls={true}\r\n    />\r\n  );\r\n}\r\n\r\nfunction File({ file }) {\r\n  const theme = useTheme();\r\n  const classes = makeStyles((theme) => ({\r\n    fileContainer: {\r\n      display: \"flex\",\r\n      alignItems: \"center\",\r\n    },\r\n    fileName: {\r\n      maxWidth: \"25vw\",\r\n      color: theme.palette.background.default,\r\n    },\r\n    fileIcon: {},\r\n  }))();\r\n\r\n  const fileName = file.name;\r\n  const srcURL = file.secure_url || URL.createObjectURL(file);\r\n  useEffect(() => {\r\n    return () => {\r\n      URL.revokeObjectURL(srcURL);\r\n    };\r\n  }, [srcURL]);\r\n\r\n  return (\r\n    <div className={classes.fileContainer}>\r\n      <Description\r\n        className={classes.fileIcon}\r\n        htmlColor={theme.palette.background.paper}\r\n      />\r\n      <Typography\r\n        className={classes.fileName}\r\n        variant=\"body1\"\r\n        noWrap\r\n        component=\"a\"\r\n        href={srcURL}\r\n        download={fileName}\r\n      >\r\n        {fileName}\r\n      </Typography>\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction MediaContent({ media, isUploading, msgTempId }) {\r\n  const classes = useStyles();\r\n\r\n  return (\r\n    <Box className={classes.mediaContainer}>\r\n      {isUploading && (\r\n        <div className={classes.progressBarContainer}>\r\n          <CircularProgressWithLabel size=\"5em\" msgtempid={msgTempId} />\r\n        </div>\r\n      )}\r\n      {media.images.map((image, index) => {\r\n        return (\r\n          <Image\r\n            key={index}\r\n            className={classes.image}\r\n            image={image}\r\n            alt=\"msg-media\"\r\n          />\r\n        );\r\n      })}\r\n      {media.videos.map((video, index) => {\r\n        return <Video key={index} video={video} />;\r\n      })}\r\n      {media.files.map((file, index) => {\r\n        return (\r\n          <File key={index} file={file} className={classes.fileContainer} />\r\n        );\r\n      })}\r\n    </Box>\r\n  );\r\n}\r\n\r\nexport default MediaContent;\r\n","import {\r\n  Avatar,\r\n  Box,\r\n  makeStyles,\r\n  Typography,\r\n  useTheme,\r\n} from \"@material-ui/core\";\r\nimport moment from \"moment\";\r\nimport React, { useEffect, useState } from \"react\";\r\nimport MediaContent from \"./MediaContent\";\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  avatar: {\r\n    height: \"2em\",\r\n    width: \"2em\",\r\n  },\r\n  timestamp: {\r\n    marginTop: \"4em\",\r\n  },\r\n}));\r\n\r\nfunction Message({ prevMsgTimestamp, msg, otherEndUser }) {\r\n  const theme = useTheme();\r\n  const classes = useStyles();\r\n  const [message, setMessage] = useState(msg);\r\n\r\n  useEffect(() => {\r\n    if (msg.mediaMessageResponse) {\r\n      msg.mediaMessageResponse.then((response) => {\r\n        setMessage(response.data);\r\n      });\r\n    }\r\n  }, [msg]);\r\n\r\n  const msgDirection = msg.from === otherEndUser.username ? \"from\" : \"to\";\r\n\r\n  function showTimestamp() {\r\n    const day = 8640000; //day in milliseconds\r\n    const halfHour = 30 * 60 * 1000; //30 min in milliseconds (30min*60sec*100ms)\r\n    const timeDifferenceBetweenMsg = moment(msg.timestamp).diff(\r\n      moment(prevMsgTimestamp)\r\n    );\r\n    const timeDifferenceFromNow = moment().diff(moment(msg.timestamp));\r\n\r\n    switch (true) {\r\n      case timeDifferenceBetweenMsg < halfHour:\r\n        return false;\r\n      case timeDifferenceFromNow < halfHour:\r\n        return moment(msg.timestamp).fromNow();\r\n      case timeDifferenceFromNow < day:\r\n        return moment(msg.timestamp).format(\"hh:mm A\");\r\n      case timeDifferenceFromNow < 7 * day:\r\n        return `${moment(msg.timestamp).format(\"ddd\")} at ${moment(\r\n          msg.timestamp\r\n        ).format(\"hh:mm A\")}`;\r\n      case timeDifferenceFromNow < 365 * day:\r\n        return `${moment(msg.timestamp).format(\"MMM D\")} at ${moment(\r\n          msg.timestamp\r\n        ).format(\"hh:mm A\")}`;\r\n      default:\r\n        return `${moment(msg.timestamp).format(\"D MMM, YYYY\")} at ${moment(\r\n          msg.timestamp\r\n        ).format(\"hh:mm A\")}`;\r\n    }\r\n  }\r\n\r\n  function getBorderRadius(msgDirection) {\r\n    if (msgDirection === \"to\") {\r\n      return \"20px 0px 20px 20px\";\r\n    }\r\n    return \"0px 20px 20px 20px\";\r\n  }\r\n  function getColor(msgDirection) {\r\n    if (msgDirection === \"to\") {\r\n      return {\r\n        background: theme.palette.primary.main,\r\n        text: theme.palette.getContrastText(theme.palette.primary.main),\r\n      };\r\n    }\r\n    return theme.palette.background.paper;\r\n  }\r\n  return (\r\n    <Box my=\"1em\">\r\n      {showTimestamp() ? (\r\n        <Typography\r\n          className={classes.timestamp}\r\n          variant=\"subtitle1\"\r\n          color=\"textSecondary\"\r\n          align=\"center\"\r\n        >\r\n          {showTimestamp()}\r\n        </Typography>\r\n      ) : null}\r\n\r\n      <Box\r\n        display=\"flex\"\r\n        justifyContent={msgDirection === \"to\" ? \"flex-end\" : \"flex-start\"}\r\n        mx=\"1em\"\r\n        my=\"0.5em\"\r\n        alignItems=\"baseline\"\r\n      >\r\n        {msgDirection === \"from\" && (\r\n          <Avatar\r\n            className={classes.avatar}\r\n            alt={otherEndUser.username.toUpperCase()}\r\n            src={otherEndUser.profilePic}\r\n          />\r\n        )}\r\n\r\n        <Box\r\n          maxWidth=\"60%\"\r\n          borderRadius={getBorderRadius(msgDirection)}\r\n          boxShadow=\"rgb(145 158 171 / 24%) 0px 8px 16px 0px\"\r\n          bgcolor={getColor(msgDirection).background}\r\n          mx={msgDirection === \"from\" ? \"1em\" : 0}\r\n          p=\"1em\"\r\n        >\r\n          <Typography\r\n            component=\"p\"\r\n            variant=\"body1\"\r\n            style={{\r\n              fontSize: \"1.1rem\",\r\n              wordBreak: \"break-word\",\r\n              overflowWrap: \"break-word\",\r\n              wordWrap: \"break-word\",\r\n              color:\r\n                msgDirection === \"to\"\r\n                  ? getColor(msgDirection).text\r\n                  : theme.palette.text.primary,\r\n            }}\r\n          >\r\n            {msg.text}\r\n          </Typography>\r\n          {(message.media.images.length > 0 ||\r\n            message.media.videos.length > 0 ||\r\n            message.media.files.length > 0) && (\r\n            <MediaContent\r\n              media={message.media}\r\n              isUploading={!!message.mediaMessageResponse}\r\n              msgTempId={message.msgTempId}\r\n            />\r\n          )}\r\n        </Box>\r\n      </Box>\r\n    </Box>\r\n  );\r\n}\r\n\r\nexport default Message;\r\n","import { createContext } from \"react\";\r\n\r\nconst LoggedInUserContext = createContext({});\r\n\r\nexport default LoggedInUserContext;\r\n","import {\r\n  Box,\r\n  IconButton,\r\n  TextField,\r\n  makeStyles,\r\n  Typography,\r\n  useTheme,\r\n} from \"@material-ui/core\";\r\nimport {\r\n  Attachment,\r\n  Close,\r\n  Description,\r\n  ImageRounded,\r\n  Send,\r\n} from \"@material-ui/icons\";\r\nimport React, { useContext, useEffect, useState } from \"react\";\r\nimport { useParams } from \"react-router\";\r\nimport { v4 as uuidv4 } from \"uuid\";\r\nimport SocketContext from \"../../../context/SocketContext\";\r\nimport videoIconOverlay from \"../../../assets/videoIconOverlay.png\";\r\nimport axios from \"../../../api/index\";\r\nimport LoggedInUserContext from \"../../../context/LoggedInUserContext\";\r\n\r\nconst useStyles = makeStyles({\r\n  root: {\r\n    width: \"60%\",\r\n    minWidth: \"300px\",\r\n    marginTop: \"auto\",\r\n    borderRadius: \"20px\",\r\n    margin: \"1.5em auto\",\r\n    padding: \"1em\",\r\n    boxShadow: \"rgb(145 158 171 / 24%) 0px 8px 16px 0px\",\r\n  },\r\n  form: {\r\n    display: \"flex\",\r\n    alignItems: \"center\",\r\n  },\r\n  selectedItemsContainer: {\r\n    padding: \"0.5em\",\r\n    maxHeight: \"25vh\",\r\n    overflowY: \"scroll\",\r\n  },\r\n  selectedMediasContainer: {\r\n    display: \"flex\",\r\n    flexWrap: \"wrap\",\r\n  },\r\n});\r\n\r\nfunction seperateImagesAndVideos(medias) {\r\n  const images = [];\r\n  const videos = [];\r\n  for (const media of medias) {\r\n    const type = media.type.split(\"/\")[0];\r\n    type === \"image\" && images.push(media);\r\n    type === \"video\" && videos.push(media);\r\n  }\r\n  if (images.length === 0 && videos.length === 0) return [null, null];\r\n  return [images, videos];\r\n}\r\n\r\nclass Message {\r\n  constructor({\r\n    from = \"\",\r\n    recipient,\r\n    images = [],\r\n    videos = [],\r\n    links = [],\r\n    files = [],\r\n    text = \"\",\r\n  }) {\r\n    this.tempMsgId = uuidv4();\r\n    this.from = from;\r\n    this.recipient = recipient;\r\n    this.media = {\r\n      images: images,\r\n      videos: videos,\r\n      links: links,\r\n      files: files,\r\n    };\r\n    this.text = text;\r\n    this.timestamp = new Date();\r\n  }\r\n}\r\n\r\nfunction MessageInput({ updateMessages }) {\r\n  const classes = useStyles();\r\n  const Socket = useContext(SocketContext);\r\n  const loggedInUser = useContext(LoggedInUserContext);\r\n  const recipient = useParams().username;\r\n\r\n  //states\r\n  const [textFieldValue, setTextFieldValue] = useState(\"\");\r\n  const [selectedImages, setSelectedImages] = useState([]);\r\n  const [selectedVideos, setSelectedVideos] = useState([]);\r\n  const [selectedFiles, setSelectedFiles] = useState([]);\r\n  const [fileInputError, setFileInputError] = useState(false);\r\n  const [typing, setTyping] = useState(\"\");\r\n\r\n  //custom events\r\n  function dispatchSendMessage(message) {\r\n    const sendMessage = new CustomEvent(\"sendMessage\", { detail: message });\r\n    document.dispatchEvent(sendMessage); //firing sendMessage event.\r\n  }\r\n  function dispatchUploadProgress(progress) {\r\n    const uploadProgress = new CustomEvent(\"uploadProgress\", {\r\n      detail: progress,\r\n    }); //{amount:Number,msgTempId}\r\n    document.dispatchEvent(uploadProgress); //firing sendMessage event.\r\n  }\r\n\r\n  useEffect(() => {\r\n    typing\r\n      ? Socket.emit(\"typing\", recipient, \"start\")\r\n      : Socket.emit(\"typing\", recipient, \"stop\");\r\n  }, [typing, recipient, Socket]);\r\n\r\n  useEffect(() => {\r\n    //reset text field when the user is changed\r\n    setTextFieldValue(\"\");\r\n  }, [recipient]);\r\n\r\n  function handleTextFieldChange(e) {\r\n    e.target.value ? setTyping(true) : setTyping(false);\r\n    setTextFieldValue(e.target.value);\r\n  }\r\n\r\n  async function sendMessage(e) {\r\n    e.preventDefault();\r\n\r\n    //check if message input contains any content\r\n    if (\r\n      !(\r\n        textFieldValue ||\r\n        selectedImages.length > 0 ||\r\n        selectedVideos.length > 0 ||\r\n        selectedFiles.length > 0\r\n      )\r\n    ) {\r\n      return;\r\n    }\r\n\r\n    if (\r\n      selectedImages.length ||\r\n      selectedVideos.length ||\r\n      selectedFiles.length\r\n    ) {\r\n      //create new Message object for clientSide\r\n      const messageForClientSide = new Message({\r\n        from: loggedInUser.username,\r\n        recipient,\r\n        images: selectedImages,\r\n        videos: selectedVideos,\r\n        links: [],\r\n        files: selectedFiles,\r\n        text: textFieldValue,\r\n      });\r\n\r\n      //setting up formData\r\n      const formData = new FormData();\r\n      formData.append(\"recipient\", recipient);\r\n      formData.append(\"text\", textFieldValue);\r\n\r\n      selectedImages.forEach((image) => formData.append(\"images\", image));\r\n      selectedVideos.forEach((video) => formData.append(\"videos\", video));\r\n      selectedFiles.forEach((file) => formData.append(\"files\", file));\r\n\r\n      const config = {\r\n        onUploadProgress: function (progressEvent) {\r\n          var percentCompleted = Math.round(\r\n            (progressEvent.loaded * 100) / progressEvent.total\r\n          );\r\n          dispatchUploadProgress({\r\n            amount: percentCompleted,\r\n            tempMsgId: messageForClientSide.tempMsgId,\r\n          });\r\n        },\r\n      };\r\n\r\n      /*\r\n        getting response promise which will be added to clientSide message\r\n        so that when response is received it can be used inside the message component\r\n        to update the message.\r\n      */\r\n      const mediaMessageResponse = axios.post(\r\n        \"/sendMediaMessage\",\r\n        formData,\r\n        config\r\n      );\r\n\r\n      mediaMessageResponse.then((response) => {\r\n        const messageId = response.data._id;\r\n        const recipientId = response.data.recipientId;\r\n        Socket.emit(\"gotMediaMessaageResponse\", messageId, recipientId);\r\n      });\r\n\r\n      messageForClientSide.mediaMessageResponse = mediaMessageResponse;\r\n\r\n      dispatchSendMessage(messageForClientSide);\r\n      updateMessages(messageForClientSide, recipient);\r\n\r\n      //reset states\r\n      setTextFieldValue(\"\");\r\n      setTyping(false);\r\n      setSelectedImages([]);\r\n      setSelectedVideos([]);\r\n      setSelectedFiles([]);\r\n    } else {\r\n      const message = new Message({\r\n        recipient,\r\n        text: textFieldValue,\r\n      });\r\n      setTextFieldValue(\"\");\r\n      setTyping(false);\r\n      updateMessages(message, recipient);\r\n      Socket.emit(\"send-message\", message);\r\n      dispatchSendMessage(message);\r\n    }\r\n  }\r\n\r\n  async function handleMediaInputChange(e) {\r\n    const [images, videos] = seperateImagesAndVideos(e.target.files);\r\n    if (!(images || videos)) {\r\n      setFileInputError(true);\r\n    } else {\r\n      setSelectedImages(images);\r\n      setSelectedVideos(videos);\r\n    }\r\n    e.target.value = \"\";\r\n  }\r\n\r\n  function handleFilesInputChange(e) {\r\n    setSelectedFiles([...e.target.files]);\r\n    e.target.value = \"\";\r\n  }\r\n\r\n  function removeSelectedImage(index) {\r\n    setSelectedImages((prevImages) => {\r\n      prevImages.splice(index, 1);\r\n      return [...prevImages];\r\n    });\r\n  }\r\n  function removeSelectedVideo(index) {\r\n    setSelectedVideos((prevVideos) => {\r\n      prevVideos.splice(index, 1);\r\n      return [...prevVideos];\r\n    });\r\n  }\r\n\r\n  function removeSelectedFile(index) {\r\n    setSelectedFiles((prevFiles) => {\r\n      prevFiles.splice(index, 1);\r\n      return [...prevFiles];\r\n    });\r\n  }\r\n\r\n  return (\r\n    <Box className={classes.root}>\r\n      {fileInputError && (\r\n        <Typography variant=\"body2\" color=\"error\" align=\"center\">\r\n          Invalid file selected!\r\n        </Typography>\r\n      )}\r\n      <Box className={classes.selectedItemsContainer}>\r\n        {(selectedImages.length > 0 || selectedVideos.length > 0) && (\r\n          <Box className={classes.selectedMediasContainer}>\r\n            {selectedImages.map((image, index) => {\r\n              return (\r\n                <SelectedMediasPreviewer\r\n                  media={image}\r\n                  key={index}\r\n                  removeSelectedMedia={removeSelectedImage}\r\n                  index={index}\r\n                />\r\n              );\r\n            })}\r\n            {selectedVideos.map((Video, index) => {\r\n              return (\r\n                <SelectedMediasPreviewer\r\n                  media={Video}\r\n                  key={index}\r\n                  removeSelectedMedia={removeSelectedVideo}\r\n                  index={index}\r\n                />\r\n              );\r\n            })}\r\n          </Box>\r\n        )}\r\n\r\n        {selectedFiles.length > 0 && (\r\n          <Box>\r\n            {selectedFiles.map((file, index) => {\r\n              return (\r\n                <SelectedFilesPreviewer\r\n                  file={file}\r\n                  key={index}\r\n                  removeSelectedFile={removeSelectedFile}\r\n                  index={index}\r\n                />\r\n              );\r\n            })}\r\n          </Box>\r\n        )}\r\n      </Box>\r\n\r\n      <form className={classes.form} onSubmit={sendMessage}>\r\n        <input\r\n          accept=\"image/*,video/*\"\r\n          style={{ display: \"none\" }}\r\n          id=\"image-btn\"\r\n          type=\"file\"\r\n          multiple\r\n          onChange={handleMediaInputChange}\r\n        />\r\n        <IconButton\r\n          variant=\"contained\"\r\n          component=\"label\"\r\n          htmlFor=\"image-btn\"\r\n          color=\"primary\"\r\n        >\r\n          <ImageRounded color=\"primary\" />\r\n        </IconButton>\r\n        <input\r\n          accept=\".pdf,.txt,.zip,.docx,.xml\"\r\n          style={{ display: \"none\" }}\r\n          id=\"attachment-btn\"\r\n          type=\"file\"\r\n          multiple\r\n          onChange={handleFilesInputChange}\r\n        />\r\n        <IconButton\r\n          variant=\"contained\"\r\n          component=\"label\"\r\n          htmlFor=\"attachment-btn\"\r\n          color=\"primary\"\r\n        >\r\n          <Attachment color=\"primary\" />\r\n        </IconButton>\r\n        <TextField\r\n          fullWidth\r\n          placeholder=\"Type something to send...\"\r\n          autoFocus\r\n          aria-label=\"message input box\"\r\n          value={textFieldValue}\r\n          onChange={handleTextFieldChange}\r\n        />\r\n        <IconButton type=\"submit\">\r\n          <Send color=\"primary\" />\r\n        </IconButton>\r\n      </form>\r\n    </Box>\r\n  );\r\n}\r\n\r\nconst useStyles_selectedMediaPreviewer = makeStyles({\r\n  previewContainer: {\r\n    position: \"relative\",\r\n    width: \"40px\",\r\n    height: \"40px\",\r\n    marginRight: \"0.8em\",\r\n    marginBottom: \"0.8em\",\r\n  },\r\n  selectedImage: {\r\n    width: \"100%\",\r\n    height: \"100%\",\r\n    objectFit: \"cover\",\r\n    borderRadius: \"20%\",\r\n  },\r\n  removeBtn: {\r\n    all: \"unset\",\r\n    position: \"absolute\",\r\n    top: \"-6px\",\r\n    right: \"-6px\",\r\n    display: \"flex\",\r\n    alignItems: \"center\",\r\n    justifyContent: \"center\",\r\n    height: \"18px\",\r\n    width: \"18px\",\r\n    textAlign: \"center\",\r\n    fontSize: \"12px\",\r\n    fontWeight: \"bold\",\r\n    backgroundColor: \"#00000088\",\r\n    borderRadius: \"50%\",\r\n    zIndex: \"100\",\r\n    \"&:hover\": {\r\n      transform: \"scale(1.1)\",\r\n    },\r\n    \"&:active\": {\r\n      transform: \"scale(1)\",\r\n    },\r\n  },\r\n  videoContainer: {\r\n    position: \"relative\",\r\n    width: \"40px\",\r\n    height: \"40px\",\r\n    marginRight: \"0.8em\",\r\n    marginBottom: \"0.8em\",\r\n    \"&>video\": {\r\n      height: \"100%\",\r\n      width: \"100%\",\r\n      objectFit: \"cover\",\r\n      borderRadius: \"20%\",\r\n    },\r\n    \"&::before\": {\r\n      content: \"''\",\r\n      backgroundImage: `url(${videoIconOverlay})`,\r\n      backgroundPosition: \"center\",\r\n      backgroundSize: \"contain\",\r\n      height: \"100%\",\r\n      width: \"100%\",\r\n      position: \"absolute\",\r\n      zIndex: \"50\",\r\n    },\r\n  },\r\n});\r\n\r\nfunction SelectedMediasPreviewer({ media, removeSelectedMedia, index }) {\r\n  const classes = useStyles_selectedMediaPreviewer();\r\n  const mediaObjectURL = URL.createObjectURL(media);\r\n\r\n  return (\r\n    <div className={classes.previewContainer}>\r\n      <button\r\n        className={classes.removeBtn}\r\n        onClick={() => {\r\n          URL.revokeObjectURL(mediaObjectURL);\r\n          removeSelectedMedia(index);\r\n        }}\r\n      >\r\n        <Close htmlColor=\"white\" fontSize=\"inherit\" />\r\n      </button>\r\n\r\n      {media.type.split(\"/\")[0] === \"image\" ? (\r\n        <img className={classes.selectedImage} src={mediaObjectURL} alt=\"img\" />\r\n      ) : (\r\n        <div className={classes.videoContainer}>\r\n          <video src={mediaObjectURL} />\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\nconst useStyles_selectedFilePreviewer = makeStyles({\r\n  selectedFilePreviewContainer: {\r\n    display: \"flex\",\r\n    alignItems: \"center\",\r\n    padding: \"1em\",\r\n  },\r\n  fileIcon: {\r\n    marginRight: \"0.3em\",\r\n  },\r\n  fileName: {\r\n    width: \"20vw\",\r\n  },\r\n  removeBtn: {\r\n    all: \"unset\",\r\n    display: \"flex\",\r\n    alignItems: \"center\",\r\n    justifyContent: \"center\",\r\n    height: \"18px\",\r\n    width: \"18px\",\r\n    margin: \"auto 0.5em\",\r\n    textAlign: \"center\",\r\n    fontSize: \"12px\",\r\n    fontWeight: \"bold\",\r\n    backgroundColor: \"#00000088\",\r\n    borderRadius: \"50%\",\r\n    \"&:hover\": {\r\n      transform: \"scale(1.1)\",\r\n    },\r\n    \"&:active\": {\r\n      transform: \"scale(1)\",\r\n    },\r\n  },\r\n});\r\n\r\nfunction SelectedFilesPreviewer({ file, removeSelectedFile, index }) {\r\n  const theme = useTheme();\r\n  const classes = useStyles_selectedFilePreviewer();\r\n  return (\r\n    <div className={classes.selectedFilePreviewContainer}>\r\n      <Description\r\n        className={classes.fileIcon}\r\n        htmlColor={theme.palette.primary.main}\r\n      />\r\n      <Typography className={classes.fileName} variant=\"body1\" noWrap>\r\n        {file.name}\r\n      </Typography>\r\n      <button\r\n        className={classes.removeBtn}\r\n        onClick={() => {\r\n          removeSelectedFile(index);\r\n        }}\r\n      >\r\n        <Close htmlColor=\"white\" fontSize=\"inherit\" />\r\n      </button>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default MessageInput;\r\n","export default \"data:image/png;base64,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\"","import { Box, makeStyles } from \"@material-ui/core\";\r\nimport React from \"react\";\r\n\r\nconst useStyles = makeStyles({\r\n  container: {\r\n    display: \"flex\",\r\n    width: \"fit-content\",\r\n    margin: \"1em\",\r\n    padding: \"0.5em\",\r\n    borderRadius: \"10px 10px 10px 0\",\r\n  },\r\n  dot: {\r\n    height: \"0.4em\",\r\n    width: \"0.4em\",\r\n    margin: \"0.2em\",\r\n    borderRadius: \"50%\",\r\n    backgroundColor: \"#00000055\",\r\n    \"&:nth-child(1)\": {\r\n      animation: \"$typing 600ms 200ms ease alternate backwards infinite\",\r\n    },\r\n    \"&:nth-child(2)\": {\r\n      animation: \"$typing 600ms 400ms ease alternate backwards infinite\",\r\n    },\r\n    \"&:nth-child(3)\": {\r\n      animation: \"$typing 600ms 600ms ease alternate backwards infinite\",\r\n    },\r\n  },\r\n  \"@keyframes typing\": {\r\n    from: {\r\n      opacity: \"0.3\",\r\n      transform: \"translateY(-50%) scale(1.1)\",\r\n    },\r\n    to: {\r\n      opacity: \"1\",\r\n    },\r\n  },\r\n});\r\n\r\nfunction TypingIndicator() {\r\n  const classes = useStyles();\r\n  return (\r\n    <Box className={classes.container} boxShadow={5}>\r\n      <div className={classes.dot}></div>\r\n      <div className={classes.dot}></div>\r\n      <div className={classes.dot}></div>\r\n    </Box>\r\n  );\r\n}\r\n\r\nexport default TypingIndicator;\r\n","import React, { useRef, useEffect, useContext, useState } from \"react\";\r\nimport { Box } from \"@material-ui/core\";\r\nimport Message from \"../ChatSection/Message\";\r\nimport SocketContext from \"../../../context/SocketContext\";\r\nimport MessageInput from \"./MessageInput\";\r\nimport axios from \"../../../api\";\r\nimport TypingIndicator from \"./TypingIndicator\";\r\n\r\nfunction MessagesContainer({ otherEndUser }) {\r\n  const messageContainer = useRef();\r\n\r\n  //contexts\r\n  const socket = useContext(SocketContext);\r\n  //states\r\n  const [messages, setMessages] = useState([]);\r\n  const [typing, setTyping] = useState({ state: \"\", user: \"\" });\r\n\r\n  function updateMessages(msg, otherSide) {\r\n    if (msg.from === otherSide || msg.recipient === otherSide) {\r\n      setMessages((prev) => {\r\n        return [...prev, msg];\r\n      });\r\n    }\r\n  }\r\n\r\n  async function getMessages(otherSide) {\r\n    if (!otherSide) return;\r\n    const res = await axios.get(`/messages/${otherSide}`);\r\n    const messages = res.data.messages;\r\n    messages &&\r\n      setMessages((prev) => {\r\n        return [...prev, ...messages];\r\n      });\r\n  }\r\n\r\n  function resetMessages() {\r\n    setMessages([]); //clear all messages\r\n  }\r\n\r\n  useEffect(() => {\r\n    //updateMessages wrapper\r\n    function addMessage(msg) {\r\n      updateMessages(msg, otherEndUser.username);\r\n    }\r\n\r\n    socket.on(\"receive-message\", addMessage); //this will receive msg and pass it into addMessage function\r\n\r\n    return () => {\r\n      socket.off(\"receive-message\", addMessage);\r\n    };\r\n  }, [socket, otherEndUser]);\r\n\r\n  useEffect(() => {\r\n    //scrolling to the buttom after the message is received.\r\n    messageContainer.current.scrollTo(0, messageContainer.current.scrollHeight);\r\n  }, [messages, typing]);\r\n\r\n  useEffect(() => {\r\n    otherEndUser && getMessages(otherEndUser.username);\r\n    socket.on(\"typing\", (state, user) => {\r\n      if (user === otherEndUser.username) {\r\n        setTyping({ state, user });\r\n      }\r\n    });\r\n\r\n    return () => {\r\n      socket.removeAllListeners(\"typing\");\r\n\r\n      resetMessages();\r\n    }; //clear all messages on unmount.\r\n  }, [otherEndUser, socket]);\r\n\r\n  return (\r\n    <>\r\n      <Box\r\n        ref={messageContainer}\r\n        style={{\r\n          overflowY: \"scroll\",\r\n        }}\r\n      >\r\n        {messages.map((msg, index) => {\r\n          return (\r\n            <Message\r\n              key={msg._id || msg.tempMsgId}\r\n              msg={msg}\r\n              prevMsgTimestamp={messages[index - 1]?.timestamp || 0}\r\n              otherEndUser={otherEndUser}\r\n            />\r\n          );\r\n        })}\r\n        {typing.state === \"start\" && typing.user === otherEndUser.username ? (\r\n          <TypingIndicator />\r\n        ) : null}\r\n      </Box>\r\n      <MessageInput updateMessages={updateMessages} />\r\n    </>\r\n  );\r\n}\r\n\r\nexport default MessagesContainer;\r\n","import { Box, Typography, useTheme } from \"@material-ui/core\";\r\nimport React, { useEffect, useState } from \"react\";\r\nimport Header from \"./Header\";\r\nimport MessagesContainer from \"./MessagesContainer\";\r\nimport { useParams } from \"react-router\";\r\nimport axios from \"../../../api\";\r\n\r\nfunction ChatSection() {\r\n  const theme = useTheme();\r\n  const { username } = useParams();\r\n  const [userInfo, setUserInfo] = useState({});\r\n\r\n  useEffect(() => {\r\n    if (username) {\r\n      (async () => {\r\n        const res = await axios.get(`userinfo/${username}`);\r\n        setUserInfo(res.data);\r\n      })();\r\n    }\r\n  }, [username]);\r\n\r\n  if (!username) {\r\n    return (\r\n      <Box\r\n        display=\"flex\"\r\n        flexGrow=\"1\"\r\n        justifyContent=\"center\"\r\n        alignItems=\"center\"\r\n      >\r\n        <Typography variant=\"h6\" align=\"center\" color=\"textSecondary\">\r\n          Open Chat To Start Messenging.\r\n        </Typography>\r\n      </Box>\r\n    );\r\n  }\r\n  return (\r\n    <Box\r\n      width={1}\r\n      style={{ height: \"100vh\" }}\r\n      display=\"flex\"\r\n      flexDirection=\"column\"\r\n      position=\"relative\"\r\n      bgcolor={theme.palette.background.default}\r\n    >\r\n      <Header userInfo={userInfo} />\r\n      <MessagesContainer otherEndUser={userInfo} />\r\n    </Box>\r\n  );\r\n}\r\n\r\nexport default ChatSection;\r\n","import React, { useState } from \"react\";\r\nimport { Redirect } from \"react-router-dom\";\r\nimport {\r\n  Box,\r\n  CircularProgress,\r\n  IconButton,\r\n  makeStyles,\r\n  Typography,\r\n} from \"@material-ui/core\";\r\nimport { PowerSettingsNew } from \"@material-ui/icons\";\r\nimport axios from \"../../../api\";\r\n\r\nconst useStyles = makeStyles({\r\n  logoutText: {\r\n    fontSize: \"0.9rem\",\r\n    fontWeight: \"bold\",\r\n  },\r\n});\r\n\r\nfunction LogoutButton() {\r\n  const classes = useStyles();\r\n  const [loggedIn, setLoggedIn] = useState(true);\r\n  const [loggingOut, setLoggingOut] = useState(false);\r\n\r\n  async function logout(type) {\r\n    try {\r\n      setLoggingOut(true);\r\n      const res = await axios.delete(\"/logout\", {\r\n        headers: { LogoutType: type },\r\n      });\r\n      if (res.status === 200) {\r\n        window.localStorage.clear();\r\n        console.log(\"cleared the localStorage\");\r\n        setLoggedIn(false);\r\n      }\r\n    } catch (err) {\r\n      setLoggingOut(false);\r\n    }\r\n  }\r\n\r\n  if (!loggedIn) {\r\n    return (\r\n      <Redirect\r\n        to={{\r\n          pathname: \"/login\",\r\n          state: {\r\n            alert: { type: \"success\", message: \"Succesfully LoggedOut!\" },\r\n          },\r\n        }}\r\n      />\r\n    );\r\n  }\r\n  return (\r\n    <>\r\n      <Box display=\"flex\" alignItems=\"center\">\r\n        <Typography className={classes.logoutText} color=\"textSecondary\">\r\n          Logout\r\n        </Typography>\r\n        <IconButton onClick={logout} size=\"small\" aria-label=\"logout\">\r\n          {loggingOut ? <CircularProgress size=\"1em\" /> : <PowerSettingsNew />}\r\n        </IconButton>\r\n      </Box>\r\n    </>\r\n  );\r\n}\r\n\r\nexport default LogoutButton;\r\n","import React from \"react\";\r\nimport { Box, Avatar, Typography, makeStyles } from \"@material-ui/core\";\r\nimport { useContext } from \"react\";\r\nimport LoggedInUserContext from \"../../../context/LoggedInUserContext\";\r\n\r\nconst useStyles = makeStyles({\r\n  username: {\r\n    fontWeight: \"bolder\",\r\n    marginLeft: \"0.5em\",\r\n  },\r\n  userAvatar: {\r\n    \"&:hover\": {\r\n      cursor: \"pointer\",\r\n    },\r\n  },\r\n});\r\n\r\nfunction UserWithAvatar({ setShowChangeProfilePicture }) {\r\n  const classes = useStyles();\r\n  const { LoggedInUser } = useContext(LoggedInUserContext);\r\n  return (\r\n    <Box display=\"flex\" alignItems=\"center\">\r\n      <Avatar\r\n        onClick={() => {\r\n          setShowChangeProfilePicture(true);\r\n        }}\r\n        className={classes.userAvatar}\r\n        alt={LoggedInUser.username}\r\n        src={LoggedInUser.profilePic}\r\n      />\r\n      <Typography className={classes.username} variant=\"h6\" color=\"textPrimary\">\r\n        {LoggedInUser.firstName} {LoggedInUser.lastName}\r\n      </Typography>\r\n    </Box>\r\n  );\r\n}\r\n\r\nexport default UserWithAvatar;\r\n","import {\r\n  Avatar,\r\n  Box,\r\n  Button,\r\n  ButtonBase,\r\n  IconButton,\r\n  makeStyles,\r\n  Popover,\r\n  Typography,\r\n  withStyles,\r\n} from \"@material-ui/core\";\r\nimport { blue } from \"@material-ui/core/colors\";\r\nimport { Clear, Done, PersonAdd } from \"@material-ui/icons\";\r\nimport axios from \"../../../api\";\r\nimport React, { useContext, useEffect, useState } from \"react\";\r\nimport { StyledBadge } from \"./Conversation\";\r\nimport { useHistory } from \"react-router-dom\";\r\nimport SocketContext from \"../../../context/SocketContext\";\r\nimport { useTheme } from \"@material-ui/styles\";\r\n\r\nconst useStyles = makeStyles({\r\n  button: {\r\n    display: \"flex\",\r\n    padding: \"1em\",\r\n    alignItems: \"center\",\r\n  },\r\n});\r\n\r\nconst styles = (theme) => ({\r\n  buttonRipple: {\r\n    color: theme.palette.primary.main,\r\n  },\r\n  main: {\r\n    padding: \"0.5em\",\r\n    width: \"100%\",\r\n    justifyContent: \"start\",\r\n    \"&:hover\": {\r\n      transform: \"scale(1.01)\",\r\n      boxShadow: \"rgb(145 158 171 / 24%) 0px 5px 16px 0px\",\r\n    },\r\n  },\r\n});\r\n\r\nconst StyledButton = withStyles(styles)((props) => (\r\n  <ButtonBase\r\n    onClick={props.onClick}\r\n    className={props.classes.main}\r\n    TouchRippleProps={{ classes: { root: props.classes.buttonRipple } }}\r\n    component=\"div\"\r\n  >\r\n    {props.children}\r\n  </ButtonBase>\r\n));\r\n\r\nfunction MutualFriendInformation({ person }) {\r\n  const theme = useTheme();\r\n  let info = \"\";\r\n  switch (true) {\r\n    case person.mutualFriends.length === 0:\r\n      return null;\r\n    case person.mutualFriends.length === 1:\r\n      info = `${person.mutualFriends[0]} is mutual`;\r\n      break;\r\n    case person.mutualFriends.length === 2:\r\n      info = `${person.mutualFriends[0]} and ${person.mutualFriends[1]} are mutual`;\r\n      break;\r\n    default:\r\n      info = `${person.mutualFriends.length} mutual friends including ${person.mutualFriends[0]} and ${person.mutualFriends[1]}`;\r\n      break;\r\n  }\r\n\r\n  return (\r\n    <Typography variant=\"body2\" style={{ color: theme.palette.grey[700] }}>\r\n      {info}\r\n    </Typography>\r\n  );\r\n}\r\n\r\nfunction People({ person, type, update }) {\r\n  const history = useHistory();\r\n  const classes = useStyles();\r\n\r\n  //context\r\n  const socket = useContext(SocketContext);\r\n\r\n  //states\r\n  const [online, setOnline] = useState(person.online);\r\n\r\n  useEffect(() => {\r\n    //updateOnlineState\r\n    function updateOnlineState(username, state) {\r\n      username === person?.username && setOnline(state);\r\n    }\r\n\r\n    socket.on(\"onlineStateChange\", updateOnlineState);\r\n    return () => {\r\n      socket.off(\"onlineStateChange\", updateOnlineState);\r\n    };\r\n  }, [socket, person]);\r\n\r\n  //open messages\r\n  function openMessages() {\r\n    if (type===\"friend\") return history.push(`/messenger/${person.username}`);\r\n  }\r\n\r\n  //send FriendRequest\r\n  async function sendFriendRequest() {\r\n    try {\r\n      await axios.post(\"/friendrequest\", {\r\n        username: person.username,\r\n        type: \"send\",\r\n      });\r\n      update();\r\n    } catch (err) {\r\n      console.log(err);\r\n    }\r\n  }\r\n\r\n  //accept FriendRequest\r\n  async function acceptFriendRequest() {\r\n    try {\r\n      await axios.post(\"/friendrequest\", {\r\n        username: person.username,\r\n        type: \"accept\",\r\n      });\r\n      update();\r\n    } catch (err) {\r\n      console.log(err);\r\n    }\r\n  }\r\n\r\n  //reject FriendRequest\r\n  async function rejectFriendRequest() {\r\n    try {\r\n      await axios.post(\"/friendrequest\", {\r\n        username: person.username,\r\n        type: \"reject\",\r\n      });\r\n      update();\r\n    } catch (err) {\r\n      console.log(err);\r\n    }\r\n  }\r\n\r\n  //cancel FriendRequest\r\n  async function cancelFriendRequest() {\r\n    try {\r\n      await axios.post(\"/friendrequest\", {\r\n        username: person.username,\r\n        type: \"cancel\",\r\n      });\r\n      update();\r\n    } catch (err) {\r\n      console.log(err);\r\n    }\r\n  }\r\n\r\n  //unFriend\r\n  async function unFriend() {\r\n    try {\r\n      await axios.post(\"/friendrequest\", {\r\n        username: person.username,\r\n        type: \"unfriend\",\r\n      });\r\n      update();\r\n    } catch (err) {\r\n      console.log(err);\r\n    }\r\n  }\r\n\r\n  //button for friend type\r\n  function FriendUnFriendBtn({ unFriend }) {\r\n    const theme = useTheme();\r\n    const [anchorEl, setAnchorEl] = React.useState(null);\r\n\r\n    const handleClick = (event) => {\r\n      setAnchorEl(event.currentTarget);\r\n    };\r\n\r\n    const handleClose = () => {\r\n      setAnchorEl(null);\r\n    };\r\n\r\n    const open = Boolean(anchorEl);\r\n    const id = open ? \"unfriend\" : undefined;\r\n\r\n    return (\r\n      <>\r\n        <Button\r\n          aria-describedby={id}\r\n          variant=\"outlined\"\r\n          color=\"primary\"\r\n          onClick={handleClick}\r\n          style={{ marginLeft: \"auto\", textTransform: \"capitalize\" }}\r\n        >\r\n          Friends\r\n        </Button>\r\n        <Popover\r\n          id={id}\r\n          open={open}\r\n          anchorEl={anchorEl}\r\n          onClose={handleClose}\r\n          anchorOrigin={{\r\n            vertical: \"bottom\",\r\n            horizontal: \"center\",\r\n          }}\r\n          transformOrigin={{\r\n            vertical: \"top\",\r\n            horizontal: \"center\",\r\n          }}\r\n        >\r\n          <Button\r\n            variant=\"outlined\"\r\n            onClick={unFriend}\r\n            style={{\r\n              marginLeft: \"auto\",\r\n              textTransform: \"capitalize\",\r\n              color: theme.palette.grey[700],\r\n            }}\r\n          >\r\n            Unfriend\r\n          </Button>\r\n        </Popover>\r\n      </>\r\n    );\r\n  }\r\n\r\n  function getButton(type) {\r\n    switch (type) {\r\n      case \"friendRequest\": \r\n        return (\r\n          <Box ml=\"auto\" display=\"flex\">\r\n            {/* accept Button */}\r\n            <IconButton onClick={acceptFriendRequest}>\r\n              <Done htmlColor={blue[600]} />\r\n            </IconButton>\r\n\r\n            {/* reject Button */}\r\n            <IconButton onClick={rejectFriendRequest}>\r\n              <Clear color=\"error\" />\r\n            </IconButton>\r\n          </Box>\r\n        );\r\n      case \"unknown\": //not friend\r\n        return (\r\n          // add friend button\r\n          <IconButton\r\n            onClick={sendFriendRequest}\r\n            style={{ marginLeft: \"auto\" }}\r\n          >\r\n            <PersonAdd />\r\n          </IconButton>\r\n        );\r\n      case \"pendingRequest\":\r\n        return (\r\n          // cancle request button\r\n          <Button\r\n            variant=\"outlined\"\r\n            color=\"primary\"\r\n            onClick={cancelFriendRequest}\r\n            style={{ marginLeft: \"auto\", textTransform: \"capitalize\" }}\r\n          >\r\n            Cancel\r\n          </Button>\r\n        );\r\n      case \"friend\":\r\n        return <FriendUnFriendBtn unFriend={unFriend} />;\r\n      default:\r\n        return null;\r\n    }\r\n  }\r\n\r\n  return (\r\n    <StyledButton\r\n      onClick={openMessages}\r\n      className={classes.button}\r\n      component=\"div\"\r\n    >\r\n      <StyledBadge\r\n        variant=\"dot\"\r\n        overlap=\"circle\"\r\n        anchorOrigin={{ vertical: \"bottom\", horizontal: \"right\" }}\r\n        badgeContent=\" \"\r\n        isonline={online ? 1 : 0}\r\n      >\r\n        <Avatar alt={person.firstName} src={person.profilePic} />\r\n      </StyledBadge>\r\n      <Box ml={2}>\r\n        <Typography\r\n          variant=\"h6\"\r\n          style={{ fontSize: \"1rem\" }}\r\n          color=\"textPrimary\"\r\n        >\r\n          {person.firstName} {person.lastName}\r\n        </Typography>\r\n        {/* mutual friends information*/}\r\n        {type ? <MutualFriendInformation person={person} /> : null}\r\n      </Box>\r\n      {getButton(type)}\r\n    </StyledButton>\r\n  );\r\n}\r\n\r\nexport default People;\r\n","import axios from \"../../../api\";\r\nimport React, { useState, useEffect } from \"react\";\r\nimport { Box, Typography } from \"@material-ui/core\";\r\nimport People from \"./People\";\r\n\r\nfunction FriendList() {\r\n  const [friendList, setFriendList] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  async function update() {\r\n    const res = await axios.get(\"/friendlist\");\r\n    setFriendList(res.data);\r\n    setLoading(false);\r\n  }\r\n\r\n  useEffect(() => {\r\n    update();\r\n  }, []);\r\n\r\n  return (\r\n    <div\r\n      style={{\r\n        width: \"100%\",\r\n        overflowY: \"scroll\",\r\n        overflowX: \"hidden\",\r\n      }}\r\n    >\r\n      {!loading && friendList.length === 0 && (\r\n        <Box p={5}>\r\n          <Typography variant=\"body1\" align=\"center\" color=\"textSecondary\">\r\n            You Have No Friends. Make Some to Start Messenging.\r\n          </Typography>\r\n        </Box>\r\n      )}\r\n      {!loading &&\r\n        friendList.length !== 0 &&\r\n        friendList.map((person) => {\r\n          return (\r\n            <People\r\n              key={person._id}\r\n              person={person}\r\n              type=\"friend\"\r\n              update={update}\r\n            />\r\n          );\r\n        })}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default FriendList;\r\n","import React, { useEffect, useState } from \"react\";\r\nimport axios from \"../../../../api\";\r\nimport { Box, Typography } from \"@material-ui/core\";\r\nimport People from \"../People\";\r\nimport { PersonAdd } from \"@material-ui/icons\";\r\n\r\nfunction FriendRequests({ update, changed }) {\r\n  const [friendRequests, setFriendRequests] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  useEffect(() => {\r\n    (async () => {\r\n      const res = await axios.get(\"/friendRequest\");\r\n      setFriendRequests(res.data);\r\n      setLoading(false);\r\n    })();\r\n  }, [changed]);\r\n\r\n  return (\r\n    <Box my=\"1em\" >\r\n      <Typography variant=\"h6\" align=\"center\" color=\"primary\">\r\n        <PersonAdd style={{ marginRight: \"0.5em\" }} />\r\n        Friend Requests\r\n      </Typography>\r\n      {!loading && friendRequests.length === 0 && (\r\n        <Box px={5}>\r\n          <Typography variant=\"body1\" align=\"center\" color=\"textSecondary\">\r\n            When you have friend requests or suggestions, you'll see them here.\r\n          </Typography>\r\n        </Box>\r\n      )}\r\n      {!loading &&\r\n        friendRequests.length !== 0 &&\r\n        friendRequests.map((Requester) => {\r\n          return (\r\n            <People\r\n              key={Requester._id}\r\n              person={Requester}\r\n              type=\"friendRequest\"\r\n              update={update}\r\n            />\r\n          );\r\n        })}\r\n    </Box>\r\n  );\r\n}\r\n\r\nexport default FriendRequests;\r\n","import React, { useEffect } from \"react\";\r\nimport axios from \"../../../../api\";\r\nimport { Box, Typography } from \"@material-ui/core\";\r\nimport People from \"../People\";\r\nimport { useState } from \"react\";\r\nimport { HourglassEmptyOutlined } from \"@material-ui/icons\";\r\n\r\nfunction PendingFriendRequests({update,changed}) {\r\n  const [pendingFriendRequests, setPendingFriendRequests] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  useEffect(() => {\r\n    (async () => {\r\n      const res = await axios.get(\"/friendRequest/pending\");\r\n      setPendingFriendRequests(res.data);\r\n            setLoading(false);\r\n\r\n    })();\r\n  }, [changed]);\r\n\r\n  return (\r\n    <Box my=\"1em\">\r\n      <Typography variant=\"h6\" align=\"center\" color=\"primary\">\r\n        <HourglassEmptyOutlined />\r\n        Pending Friend Requests\r\n      </Typography>\r\n      {!loading && pendingFriendRequests.length === 0 && (\r\n        <Box px={5}>\r\n          <Typography variant=\"body1\" align=\"center\" color=\"textSecondary\">\r\n            When you have pending friend requests, you'll see them here.\r\n          </Typography>\r\n        </Box>\r\n      )}\r\n      {!loading &&\r\n        pendingFriendRequests.length !== 0 &&\r\n        pendingFriendRequests.map((Requested) => {\r\n          return (\r\n            <People\r\n              key={Requested._id}\r\n              person={Requested}\r\n              type=\"pendingRequest\"\r\n              update={update}\r\n            />\r\n          );\r\n        })}\r\n    </Box>\r\n  );\r\n}\r\n\r\nexport default PendingFriendRequests;\r\n","import { Box, Typography } from \"@material-ui/core\";\r\nimport { EmojiPeople } from \"@material-ui/icons\";\r\nimport React, { useEffect, useState } from \"react\";\r\nimport axios from \"../../../../api\";\r\nimport People from \"../People\";\r\n\r\nfunction PeopleYouMayKnow({ update, changed }) {\r\n  const [peopleYouMayKnow, setPeopleYouMayKnow] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  useEffect(() => {\r\n    (async () => {\r\n      const res = await axios.get(\"/peopleyoumayknow\");\r\n      setPeopleYouMayKnow(res.data);\r\n      setLoading(false);\r\n    })();\r\n  }, [changed]);\r\n\r\n  return (\r\n    <Box mt=\"1em\">\r\n      <Typography variant=\"h6\" align=\"center\" color=\"primary\">\r\n        <EmojiPeople />\r\n        People You May Know\r\n      </Typography>\r\n      {!loading && peopleYouMayKnow.length === 0 && (\r\n        <Box px={5}>\r\n          <Typography variant=\"body1\" align=\"center\" color=\"textSecondary\">\r\n            When you have friend's suggestions, you'll see them here.\r\n          </Typography>\r\n        </Box>\r\n      )}\r\n      {!loading &&\r\n        peopleYouMayKnow.length !== 0 &&\r\n        peopleYouMayKnow.map((Person) => {\r\n          return (\r\n            <People\r\n              key={Person._id}\r\n              person={Person}\r\n              type=\"unknown\"\r\n              update={update}\r\n            />\r\n          );\r\n        })}\r\n    </Box>\r\n  );\r\n}\r\n\r\nexport default PeopleYouMayKnow;\r\n","import { Divider } from \"@material-ui/core\";\r\nimport React, { useState } from \"react\";\r\nimport FriendRequests from \"./FriendRequests\";\r\nimport PendingFriendRequests from \"./PendingFriendRequests\";\r\nimport PeopleYouMayKnow from \"./PeopleYouMayKnow\";\r\n\r\nfunction FindFriends() {\r\n  const [changed, setChanged] = useState();\r\n\r\n  function update() {\r\n    setChanged(Math.random());\r\n  }\r\n  return (\r\n    <div\r\n      style={{\r\n        width: \"100%\",\r\n        overflowY: \"scroll\",\r\n        overflowX: \"hidden\",\r\n      }}\r\n    >\r\n      <FriendRequests changed={changed} update={update} />\r\n      <Divider variant=\"middle\" />\r\n      <PendingFriendRequests changed={changed} update={update} />\r\n      <Divider variant=\"middle\" />\r\n      <PeopleYouMayKnow changed={changed} update={update} />\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default FindFriends;\r\n","import React, { useContext, useEffect, useState } from \"react\";\r\nimport axios from \"../../../api\";\r\nimport axiosMain from \"axios\";\r\nimport Conversation from \"./Conversation\";\r\nimport SocketContext from \"../../../context/SocketContext\";\r\n\r\nasync function getConversations(source) {\r\n  const res = await axios.get(`/conversations`, {\r\n    cancelToken: source?.token,\r\n  });\r\n  return res.data;\r\n}\r\n\r\nfunction ConversationsContainer() {\r\n  //contexts\r\n  const socket = useContext(SocketContext);\r\n\r\n  //states\r\n  const [conversations, setConversations] = useState([]);\r\n\r\n  function onMessageSend(listener) {\r\n    document.addEventListener(\"sendMessage\", listener);\r\n  }\r\n  function offMessageSend(listener) {\r\n    document.removeEventListener(\"sendMessage\", listener);\r\n  }\r\n\r\n  function moveRecentConversationToTop(msg) {\r\n    const message = msg.detail ? msg.detail : msg;\r\n\r\n    setConversations((prevConversations) => {\r\n      if (prevConversations.length === 0) {\r\n        getConversations().then((conversations) => {\r\n          setConversations(conversations);\r\n        });\r\n        return [];\r\n      }\r\n      const index = prevConversations.findIndex((conversation) => {\r\n        if (conversation?.with === message.recipient) {\r\n          return true;\r\n        }\r\n        return false;\r\n      });\r\n      const recentConversation = prevConversations.splice(index, 1)[0];\r\n      prevConversations.splice(0, 0, recentConversation);\r\n      return [...prevConversations];\r\n    });\r\n  }\r\n\r\n  useEffect(() => {\r\n    const CancelToken = axiosMain.CancelToken; //axiosMain is axios\r\n    const source = CancelToken.source();\r\n\r\n    getConversations(source).then((conversations) => {\r\n      setConversations(conversations);\r\n    });\r\n\r\n    onMessageSend(moveRecentConversationToTop);\r\n\r\n    socket.on(\"receive-message\", moveRecentConversationToTop);\r\n\r\n    return () => {\r\n      // Cancel request\r\n      source.cancel();\r\n      offMessageSend(moveRecentConversationToTop);\r\n      socket.off(\"receive-message\", moveRecentConversationToTop);\r\n    };\r\n  }, [socket]);\r\n\r\n  return (\r\n    <div\r\n      style={{\r\n        width: \"100%\",\r\n        height: \"100%\",\r\n        marginTop: \"0.5em\",\r\n        overflowY: \"scroll\",\r\n        overflowX: \"hidden\",\r\n      }}\r\n    >\r\n      {conversations.map((conversation) => (\r\n        <Conversation\r\n          key={conversation._id}\r\n          lastMessage={\r\n            conversation.messages.length &&\r\n            conversation.messages[conversation.messages.length - 1]\r\n          }\r\n          conversationWith={conversation.with}\r\n        />\r\n      ))}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default ConversationsContainer;\r\n","import { makeStyles, Tab, Tabs, Box } from \"@material-ui/core\";\r\nimport { Chat, GroupAdd, People } from \"@material-ui/icons\";\r\nimport React, { createContext, useState } from \"react\";\r\nimport FriendList from \"./FriendList\";\r\nimport FindFriends from \"./FindFriends/index\";\r\nimport ConversationsContainer from \"./ConversationsContainer\";\r\n\r\n//creating the contexts\r\nconst FriendListContext = createContext();\r\nconst MessagesContext = createContext();\r\nconst FriendRequestsContext = createContext();\r\nconst PendingFriendRequestsContext = createContext();\r\nconst PeopleYouMayKnowContext = createContext();\r\n\r\nconst useStyles = makeStyles({\r\n  tab: {\r\n    width: `${(1 / 3) * 100}%`,\r\n    \"@media (min-width: 600px)\": {\r\n      minWidth: \"60px\",\r\n    },\r\n  },\r\n});\r\n\r\nfunction SelectionMenu() {\r\n  const classes = useStyles();\r\n  const [index, setIndex] = useState(0);\r\n\r\n\r\n  const handleChange = (event, newIndex) => {\r\n    setIndex(newIndex);\r\n  };\r\n  return (\r\n    <>\r\n      <Box mt={2} boxShadow=\"rgb(145 158 171 / 24%) 0px 3px 8px 0px\" >\r\n        <Tabs\r\n          value={index}\r\n          onChange={handleChange}\r\n          variant=\"fullWidth\"\r\n          indicatorColor=\"primary\"\r\n          textColor=\"primary\"\r\n          aria-label=\"icon tabs example\"\r\n        >\r\n          <Tab className={classes.tab} icon={<Chat />} aria-label=\"phone\" />\r\n          <Tab\r\n            className={classes.tab}\r\n            icon={<People />}\r\n            aria-label=\"favorite\"\r\n          />\r\n          <Tab\r\n            className={classes.tab}\r\n            icon={<GroupAdd />}\r\n            aria-label=\"person\"\r\n          />\r\n        </Tabs>\r\n      </Box>\r\n      <TabPanel\r\n        components={[\r\n          <ConversationsContainer />,\r\n          <FriendList />,\r\n          <FindFriends />,\r\n        ]}\r\n        index={index}\r\n      />\r\n    </>\r\n  );\r\n}\r\n\r\nfunction TabPanel({ components, index }) {\r\n  return components[index];\r\n}\r\n\r\nexport default SelectionMenu;\r\nexport {\r\n  MessagesContext,\r\n  FriendListContext,\r\n  FriendRequestsContext,\r\n  PendingFriendRequestsContext,\r\n  PeopleYouMayKnowContext,\r\n};\r\n","import { Box, makeStyles, Typography, useTheme } from \"@material-ui/core\";\r\nimport React, { useEffect, useRef, useState } from \"react\";\r\nimport axios from \"../../../../api\";\r\nimport axiosMain from \"axios\";\r\nimport People from \"../People\";\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  searchResultsContainer: {\r\n    position: \"absolute\",\r\n    overflowY: \"scroll\",\r\n    maxHeight: \"50vh\",\r\n    width: \"calc(100% - 2em)\",\r\n    margin: \"0 1em\",\r\n    left: \"0\",\r\n    padding: \"0.5em 0.2em 0.5em 0.5em\",\r\n    backgroundColor: theme.palette.background.paper,\r\n    borderRadius: \"0 0 10px 10px\",\r\n    zIndex: \"1000\",\r\n    boxShadow: \"rgb(145 158 171 / 10%) 0px 2px 5px 3px\",\r\n  },\r\n}));\r\n\r\nfunction SearchResults({ searchText }) {\r\n  const theme = useTheme();\r\n  const classes = useStyles();\r\n  const [searchResults, setSearchResults] = useState([]);\r\n  const [changed, setChanged] = useState();\r\n  const searchResultsContainer = useRef();\r\n\r\n  function update() {\r\n    setChanged(Math.random());\r\n  }\r\n\r\n  useEffect(() => {\r\n    const cancelTokenSource = axiosMain.CancelToken.source();\r\n\r\n    async function getSearchResults(searchTerm) {\r\n      const res = await axios.get(`/search?search_term=${searchTerm}`, {\r\n        cancelToken: cancelTokenSource.token,\r\n      });\r\n      return res.data;\r\n    }\r\n\r\n    if (searchText) {\r\n      getSearchResults(searchText).then((results) => {\r\n        setSearchResults(results);\r\n      });\r\n    }\r\n\r\n    return () => {\r\n      cancelTokenSource.cancel();\r\n    };\r\n  }, [changed, searchText]);\r\n\r\n  return (\r\n    <Box\r\n      className={classes.searchResultsContainer}\r\n      ref={searchResultsContainer}\r\n    >\r\n      {searchText && !searchResults.length ? (\r\n        <Typography\r\n          style={{ margin: \"0.5em\" }}\r\n          align=\"center\"\r\n          color=\"textSecondary\"\r\n        >\r\n          No Results Found!\r\n        </Typography>\r\n      ) : null}\r\n\r\n      {/* friends */}\r\n      {searchResults?.map((person) => {\r\n        if (person.isFriend) {\r\n          return (\r\n            <People\r\n              key={person._id}\r\n              person={person}\r\n              type=\"friend\"\r\n              update={update}\r\n            />\r\n          );\r\n        }\r\n        return null;\r\n      })}\r\n\r\n      {/* more People (unknown persons) */}\r\n      {searchResults.some((person) => {\r\n        return !person.isFriend;\r\n      }) ? (\r\n        <>\r\n          <Typography\r\n            variant=\"body1\"\r\n            style={{\r\n              fontWeight: \"bold\",\r\n              margin: \"0.4em 0\",\r\n              marginLeft: \"0.8em\",\r\n              color: theme.palette.primary.main,\r\n            }}\r\n          >\r\n            More People\r\n          </Typography>\r\n          {searchResults?.map((person) => {\r\n            if (person.isRequestPending)\r\n              return (\r\n                <People\r\n                  key={person._id}\r\n                  type=\"pendingRequest\"\r\n                  person={person}\r\n                  update={update}\r\n                />\r\n              );\r\n            if (person.hasSentFriendRequest)\r\n              return (\r\n                <People\r\n                  key={person._id}\r\n                  type=\"friendRequest\"\r\n                  person={person}\r\n                  update={update}\r\n                />\r\n              );\r\n            if (!person.isFriend) {\r\n              return (\r\n                <People\r\n                  key={person._id}\r\n                  type=\"unknown\"\r\n                  person={person}\r\n                  update={update}\r\n                />\r\n              );\r\n            }\r\n            return null;\r\n          })}\r\n        </>\r\n      ) : null}\r\n    </Box>\r\n  );\r\n}\r\n\r\nexport default SearchResults;\r\n","import React, { useEffect, useRef, useState } from \"react\";\r\nimport { Box, IconButton, makeStyles } from \"@material-ui/core\";\r\nimport SearchResults from \"./SearchResults\";\r\nimport { Search } from \"@material-ui/icons\";\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  root: {\r\n    margin: \"1em\",\r\n  },\r\n  searchForm: {\r\n    display: \"flex\",\r\n    paddingLeft: \"1em\",\r\n    width: \"100%\",\r\n  },\r\n  searchInput: {\r\n    color: theme.palette.text.primary,\r\n    fontSize: \"1rem\",\r\n    background: \"transparent\",\r\n    outline: \"none\",\r\n    border: \"none\",\r\n    width: \"100%\",\r\n    \"&::placeholder\": {\r\n      color: theme.palette.text.secondary,\r\n      fontSize: \"1rem\",\r\n    },\r\n  },\r\n}));\r\n\r\nfunction SearchBox() {\r\n  const classes = useStyles();\r\n  const [searchText, setSearchText] = useState();\r\n  const [showSearchResults, setShowSearchResults] = useState(false);\r\n  //refs\r\n  const searchBoxRef = useRef();\r\n\r\n  function handleChange(e) {\r\n    setSearchText(e.target.value);\r\n  }\r\n\r\n  function handleSubmit(e) {\r\n    e.preventDefault();\r\n    searchText && setShowSearchResults(true);\r\n  }\r\n\r\n  function handleClickOutside(e) {\r\n    if (searchBoxRef.current && !searchBoxRef.current.contains(e.target))\r\n      setShowSearchResults(false);\r\n  }\r\n\r\n  useEffect(() => {\r\n    searchText ? setShowSearchResults(true) : setShowSearchResults(false);\r\n  }, [searchText]);\r\n\r\n  useEffect(() => {\r\n    document.addEventListener(\"click\", handleClickOutside);\r\n    return () => {\r\n      document.removeEventListener(\"click\", handleClickOutside);\r\n    };\r\n  }, []);\r\n\r\n  return (\r\n    <>\r\n      <Box\r\n        className={classes.root}\r\n        borderRadius=\"5px\"\r\n        boxShadow=\"rgb(145 158 171 / 10%) 0px 2px 5px 3px\"\r\n        tabIndex=\"-1\"\r\n        onFocus={() => {\r\n          searchText && !showSearchResults && setShowSearchResults(true);\r\n        }}\r\n        ref={searchBoxRef}\r\n      >\r\n        <form className={classes.searchForm} onSubmit={handleSubmit}>\r\n          <input\r\n            className={classes.searchInput}\r\n            placeholder=\"Search...\"\r\n            value={searchText}\r\n            onFocus={() => {\r\n              searchText && setShowSearchResults(true);\r\n            }}\r\n            onChange={(e) => {\r\n              handleChange(e);\r\n            }}\r\n          />\r\n          <IconButton type=\"submit\">\r\n            <Search />\r\n          </IconButton>\r\n        </form>\r\n        {showSearchResults ? <SearchResults searchText={searchText} /> : null}\r\n      </Box>\r\n    </>\r\n  );\r\n}\r\n\r\nexport default SearchBox;\r\n","import React from \"react\";\r\nimport { Box, makeStyles } from \"@material-ui/core\";\r\nimport LogoutButton from \"./LogoutButton\";\r\nimport UserWithAvatar from \"./UserWithAvatar\";\r\nimport SelectionMenu from \"./SelectionMenu\";\r\nimport SearchBox from \"./SearchBox/index.jsx\";\r\nimport { useTheme } from \"@material-ui/styles\";\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  root: {\r\n    position: \"relative\",\r\n    display: \"flex\",\r\n    flexDirection: \"column\",\r\n    maxWidth: \"400px\",\r\n    minWidth: \"400px\",\r\n    height: \"100vh\",\r\n    [theme.breakpoints.down(\"sm\")]: {\r\n      minWidth: \"100%\",\r\n    },\r\n  },\r\n}));\r\n\r\nfunction SideNavigation({ setShowChangeProfilePicture }) {\r\n  const theme = useTheme();\r\n  const classes = useStyles();\r\n  return (\r\n    <Box\r\n      className={classes.root}\r\n      borderRight={`2px solid ${theme.palette.grey[200]}`}\r\n    >\r\n      <Box\r\n        px={2}\r\n        py={3}\r\n        display=\"flex\"\r\n        alignItems=\"center\"\r\n        justifyContent=\"space-between\"\r\n      >\r\n        <UserWithAvatar\r\n          setShowChangeProfilePicture={setShowChangeProfilePicture}\r\n        />\r\n        <LogoutButton />\r\n      </Box>\r\n      <SearchBox />\r\n      <SelectionMenu />\r\n    </Box>\r\n  );\r\n}\r\n\r\nexport default SideNavigation;\r\n","import {\r\n  Avatar,\r\n  Box,\r\n  Button,\r\n  CircularProgress,\r\n  makeStyles,\r\n  Modal,\r\n  Typography,\r\n} from \"@material-ui/core\";\r\nimport { Image, Publish } from \"@material-ui/icons\";\r\nimport React, { useContext, useState } from \"react\";\r\nimport axios from \"../../api\";\r\nimport Alert from \"../Utils/Alert\";\r\nimport LoggedInUserContext from \"../../context/LoggedInUserContext\";\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  modal: {\r\n    display: \"flex\",\r\n    justifyContent: \"center\",\r\n    alignItems: \"center\",\r\n  },\r\n  modal__content: {\r\n    height: \"600px\",\r\n    width: \"400px\",\r\n    borderRadius: \"10px\",\r\n    backgroundColor: theme.palette.background.paper,\r\n    boxShadow: theme.shadows[5],\r\n    outline: \"none\",\r\n  },\r\n  avatar: {\r\n    margin: \"1em 0\",\r\n    height: \"170px\",\r\n    width: \"170px\",\r\n  },\r\n  btnsContainer: {\r\n    margin: \"1.5em 0\",\r\n  },\r\n  greetingText: {\r\n    marginTop: \"0.3em\",\r\n  },\r\n  infoText: {\r\n    fontSize: \"1.2rem\",\r\n  },\r\n  fullNameText: {\r\n    marginTop: \"1.5em\",\r\n    fontSize: \"1.8rem\",\r\n    fontWeight: \"bold\",\r\n    color: \"#2e2e2e\",\r\n  },\r\n  usernameText: {\r\n    marginTop: \"0.3em\",\r\n    marginBottom: \"0.8em\",\r\n    fontSize: \"1.4rem\",\r\n    fontWeight: \"500\",\r\n    color: \"#2e2e2e\",\r\n  },\r\n  btn: {\r\n    margin: \"0.5em 0\",\r\n    padding: \"0.5em\",\r\n    width: \"75%\",\r\n    \"&:last-child\": {\r\n      margin: \"3em 0\",\r\n    },\r\n  },\r\n}));\r\n\r\nfunction ChangeProfilePicture({ greeting, setShowChangeProfilePicture }) {\r\n  const classes = useStyles();\r\n  const { LoggedInUser, setLoggedInUser } = useContext(LoggedInUserContext);\r\n\r\n  //states\r\n  const [profilePicture, setProfilePicture] = useState(LoggedInUser.profilePic);\r\n  const [selectedImage, setSelectedImage] = useState();\r\n  const [open, setOpen] = useState(true);\r\n  const [uploading, setUploading] = useState(false);\r\n  const [alert, setAlert] = useState();\r\n\r\n  const showProfilePicture = (e) => {\r\n    const reader = new FileReader();\r\n    e.target.files[0] && reader.readAsDataURL(e.target.files[0]); //This reads the file as urlencoded base64 string.\r\n    reader.addEventListener(\"load\", () => {\r\n      setSelectedImage(reader.result);\r\n      setProfilePicture(reader.result);\r\n    });\r\n  };\r\n\r\n  async function uploadProfilePicture() {\r\n    if (selectedImage) {\r\n      try {\r\n        setUploading(true); //start the loading spinner\r\n        const res = await axios.post(\"/uploadprofilepic\", {\r\n          data: profilePicture,\r\n        });\r\n        setUploading(false); //stop the loading spinner\r\n        setAlert({\r\n          type: \"success\",\r\n          message: res.data.message,\r\n        });\r\n\r\n        //update the profilePic property of the LoggedInUserContext\r\n        setLoggedInUser((prev) => {\r\n          const userInfo = { ...prev };\r\n          userInfo.profilePic = res.data.profilePicURL;\r\n          return userInfo;\r\n        });\r\n        /*\r\n          alert completes at 2000 so waiting for alert to hide before closing/unmounting the modal.\r\n          After 2000ms the showAlert state is set to false. So if the modal is closed/unmounted\r\n          before the 2000ms, setState will be called after it. So error will occur \r\n          trying to setState of the component after unmount.\r\n        */\r\n        setTimeout(handleClose, 2100);\r\n      } catch (err) {\r\n        setAlert({\r\n          type: \"error\",\r\n          message: err.response?.data.message || err.message,\r\n        });\r\n        setUploading(false);\r\n      }\r\n    } else {\r\n      setAlert({ type: \"warning\", message: \"select image first\" });\r\n    }\r\n  }\r\n\r\n  function handleClose() {\r\n    setOpen(false);\r\n    setShowChangeProfilePicture && setShowChangeProfilePicture(false);\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <Modal className={classes.modal} open={open}>\r\n        <Box\r\n          display=\"flex\"\r\n          flexDirection=\"column\"\r\n          alignItems=\"center\"\r\n          className={classes.modal__content}\r\n        >\r\n          {alert ? <Alert type={alert.type}>{alert.message}</Alert> : null}\r\n          <Typography\r\n            className={classes.fullNameText}\r\n            variant=\"h5\"\r\n            align=\"center\"\r\n          >\r\n            {LoggedInUser.firstName} {LoggedInUser.lastName}\r\n          </Typography>\r\n          <Typography\r\n            className={classes.usernameText}\r\n            variant=\"h6\"\r\n            align=\"center\"\r\n          >\r\n            @{LoggedInUser.username}\r\n          </Typography>\r\n          <Typography\r\n            className={`${classes.txtWhite} ${classes.infoText}`}\r\n            align=\"center\"\r\n          >\r\n            {greeting ? (\r\n              <>\r\n                Welcome to Messenger.\r\n                <br />\r\n                Set your Profile Picture to continue.\r\n              </>\r\n            ) : null}\r\n          </Typography>\r\n          <Avatar\r\n            className={classes.avatar}\r\n            src={profilePicture}\r\n            alt=\"avatar\"\r\n          />\r\n\r\n          {uploading ? <CircularProgress size=\"2rem\" /> : null}\r\n\r\n          {/* Image upload Input */}\r\n          <Box\r\n            display=\"flex\"\r\n            flexDirection=\"column\"\r\n            alignItems=\"center\"\r\n            width={1}\r\n            mt=\"auto\"\r\n            mb=\"2em\"\r\n          >\r\n            <input\r\n              accept=\"image/*\"\r\n              style={{ display: \"none\" }}\r\n              id=\"raised-button-file\"\r\n              type=\"file\"\r\n              onChange={showProfilePicture}\r\n            />\r\n\r\n            <Button\r\n              className={classes.btn}\r\n              variant=\"contained\"\r\n              component=\"label\"\r\n              htmlFor=\"raised-button-file\"\r\n              color=\"primary\"\r\n              endIcon={<Image />}\r\n            >\r\n              Choose\r\n            </Button>\r\n            <Button\r\n              className={classes.btn}\r\n              onClick={uploadProfilePicture}\r\n              variant=\"contained\"\r\n              component=\"span\"\r\n              color=\"primary\"\r\n              endIcon={<Publish />}\r\n            >\r\n              Upload\r\n            </Button>\r\n\r\n            {/* skip/close button */}\r\n            <Button\r\n              className={classes.btn}\r\n              variant=\"contained\"\r\n              color=\"secondary\"\r\n              onClick={handleClose}\r\n            >\r\n              {greeting ? \"Skip Now\" : \"Close\"}\r\n            </Button>\r\n          </Box>\r\n        </Box>\r\n      </Modal>\r\n    </>\r\n  );\r\n}\r\n\r\nexport default ChangeProfilePicture;\r\n","import React, { useEffect, useState } from \"react\";\r\nimport { CALLSTATES } from \".\";\r\n\r\nfunction updateTimer(startTime) {\r\n  let timeNow = new Date();\r\n  let timerHrs = timeNow.getHours() - startTime.getHours();\r\n  let timerMin = (() => {\r\n    let min = timeNow.getMinutes() - startTime.getMinutes();\r\n    if (min < 0) {\r\n      min = min + 60;\r\n      timerHrs--;\r\n    }\r\n    return min;\r\n  })();\r\n  let timerSec = (() => {\r\n    let sec = timeNow.getSeconds() - startTime.getSeconds();\r\n    if (sec < 0) {\r\n      sec = sec + 60;\r\n      timerMin--;\r\n    }\r\n    return sec;\r\n  })();\r\n  return `${timerHrs > 0 ? (\"0\" + timerHrs).slice(-2) + \":\" : \"\"}${(\r\n    \"0\" + timerMin\r\n  ).slice(-2)}:${(\"0\" + timerSec).slice(-2)}`; // format hrs:min:sec if hrs exits else  min:sec\r\n}\r\n\r\nfunction CallTimer({ callStartedTime, callState }) {\r\n  const [timer, setTimer] = useState();\r\n\r\n  useEffect(() => {\r\n    if (callStartedTime) {\r\n      setTimer(updateTimer(callStartedTime));\r\n      if (![CALLSTATES.HANGUP, CALLSTATES.CONNECTIONLOST].includes(callState)) {\r\n        const updateInterval = setInterval(() => {\r\n          setTimer(updateTimer(callStartedTime));\r\n        }, 1000);\r\n\r\n        return () => {\r\n          clearInterval(updateInterval);\r\n        };\r\n      }\r\n    }\r\n  }, [callStartedTime, callState]);\r\n\r\n  return <>{timer}</>;\r\n}\r\n\r\nexport default CallTimer;\r\n","import { useEffect } from \"react\";\r\n\r\nimport connecting from \"../../../assets/sounds/connecting.mp3\";\r\nimport connected from \"../../../assets/sounds/connected.mp3\";\r\nimport calling from \"../../../assets/sounds/calling.mp3\";\r\nimport callFailed from \"../../../assets/sounds/callFailed.mp3\";\r\nimport ringing from \"../../../assets/sounds/ringing.mp3\";\r\nimport reconnecting from \"../../../assets/sounds/reconnecting.mp3\";\r\nimport connectionLost from \"../../../assets/sounds/connectionLost.mp3\";\r\nimport hangup from \"../../../assets/sounds/hangup.mp3\";\r\n\r\nconst sounds = {\r\n  connecting,\r\n  connected,\r\n  calling,\r\n  callFailed,\r\n  ringing,\r\n  reconnecting,\r\n  connectionLost,\r\n  hangup,\r\n};\r\n\r\nfunction useCallSounds(callState) {\r\n  useEffect(() => {\r\n    if (\r\n      callState &&\r\n      callState !== \"noAnswer\" &&\r\n      callState !== \"busy\" &&\r\n      callState !== \"ongoing\"\r\n    ) {\r\n      var audio = new Audio(sounds[callState]);\r\n      audio.load();\r\n      if (\r\n        callState === \"connecting\" ||\r\n        callState === \"ringing\" ||\r\n        callState === \"reconnecting\"\r\n      )\r\n        audio.loop = true;\r\n      audio.play();\r\n    }\r\n    return () => {\r\n      if (audio) audio.pause();\r\n    };\r\n  }, [callState]);\r\n}\r\n\r\nexport default useCallSounds;\r\n","export default __webpack_public_path__ + \"static/media/connecting.bbd9a0bf.mp3\";","export default __webpack_public_path__ + \"static/media/connected.2638f3bf.mp3\";","export default __webpack_public_path__ + \"static/media/calling.60d66047.mp3\";","export default __webpack_public_path__ + \"static/media/callFailed.11708baa.mp3\";","export default __webpack_public_path__ + \"static/media/ringing.6cf9231c.mp3\";","export default __webpack_public_path__ + \"static/media/reconnecting.bbd9a0bf.mp3\";","export default __webpack_public_path__ + \"static/media/connectionLost.11708baa.mp3\";","export default __webpack_public_path__ + \"static/media/hangup.abe2a5aa.mp3\";","import {\r\n  Avatar,\r\n  Box,\r\n  IconButton,\r\n  makeStyles,\r\n  Slide,\r\n  Typography,\r\n  useTheme,\r\n} from \"@material-ui/core\";\r\nimport { Call, CallEnd, Mic, MicOff, VideoCall } from \"@material-ui/icons\";\r\nimport React, { useEffect, useRef, useState } from \"react\";\r\nimport { createRef } from \"react\";\r\nimport Timer from \"./CallTimer\";\r\n// import Sounds from \"./Sounds\";\r\nimport { CALLSTATES } from \".\"; //STRING CONSTANTS\r\nimport useCallSounds from \"./useCallSounds\";\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  call_alert: {\r\n    width: \"fit-content\",\r\n    padding: \"1em\",\r\n    display: \"flex\",\r\n    alignItems: \"center\",\r\n    position: \"absolute\",\r\n    top: \"5px\",\r\n    left: \"50%\",\r\n    transform: \"translate(-50%)\",\r\n    zIndex: \"2000\",\r\n    borderRadius: \"20px\",\r\n    backgroundColor: theme.palette.background.paper,\r\n  },\r\n\r\n  //ripple animation around Avatar\r\n  call_animation: {\r\n    width: \"3em\",\r\n    height: \"3em\",\r\n    display: \"flex\",\r\n    justifyContent: \"center\",\r\n    alignItems: \"center\",\r\n    position: \"relative\",\r\n    borderRadius: \"50%\",\r\n    animation: \"$ripple 2s ease infinite\",\r\n    webkitBackfaceVisibility: \"hidden\",\r\n    mozBackfaceVisibility: \"hidden\",\r\n    msBackfaceVisibility: \"hidden\",\r\n    backfaceVisibility: \"hidden\",\r\n  },\r\n\r\n  \"@keyframes ripple\": {\r\n    \"0%\": {\r\n      transform: \" scale(1)\",\r\n    },\r\n    \"15%\": {\r\n      boxShadow:\r\n        \"0 0 0 3px\" +\r\n        (theme.palette.type === \"dark\" ? \"#ffffff66\" : \"#aadff866\"),\r\n    },\r\n    \"25%\": {\r\n      boxShadow:\r\n        \" 0 0 0 5px\" +\r\n        (theme.palette.type === \"dark\" ? \"#ffffff66\" : \"#aadff866\") +\r\n        \", 0 0 0 10px\" +\r\n        (theme.palette.type === \"dark\" ? \"#ffffff33\" : \"#aadff833\"),\r\n    },\r\n  },\r\n  avatar: {\r\n    height: \"2.5em\",\r\n    width: \"2.5em\",\r\n  },\r\n  callerName: {\r\n    fontSize: \"1.1rem\",\r\n  },\r\n}));\r\n\r\nconst useButtonStyles = makeStyles((theme) => ({\r\n  button: {\r\n    marginLeft: \"0.2em\",\r\n    backgroundColor: theme.palette.background.default,\r\n  },\r\n  button_incoming: {\r\n    margin: \"0 0.2em\",\r\n    backgroundColor: theme.palette.background.default,\r\n    animation: \"$vibrate 100ms infinite alternate ease-in-out\",\r\n  },\r\n  \"@keyframes vibrate\": {\r\n    from: {\r\n      transform: \"rotateZ(-5deg) translateY(0px)\",\r\n    },\r\n    to: {\r\n      transform: \"rotateZ(5deg) translateY(1px)\",\r\n    },\r\n  },\r\n}));\r\n\r\nfunction CallStatus({ callState, callStartedTime }) {\r\n  const theme = useTheme();\r\n\r\n  const getTextColor = () => {\r\n    switch (callState) {\r\n      case CALLSTATES.CALLFAILED:\r\n      case CALLSTATES.CONNECTIONLOST:\r\n      case \"hangup\":\r\n        return theme.palette.error.main;\r\n      case CALLSTATES.NOANSWER:\r\n      case CALLSTATES.BUSY:\r\n        return theme.palette.warning.main;\r\n\r\n      default:\r\n        return theme.palette.text.secondary;\r\n    }\r\n  };\r\n  return (\r\n    <Typography\r\n      style={{ color: getTextColor() || theme.palette.text.secondary }}\r\n      variant=\"body1\"\r\n    >\r\n      {\r\n        {\r\n          connecting: \"connecting. . .\",\r\n          connected: \"connected\",\r\n          callFailed: \"call Failed!\",\r\n          calling: \"calling. . .\",\r\n          ringing: \"Incoming Call. . .\",\r\n          noAnswer: \"No Answer!\",\r\n          busy: \"Busy!\",\r\n          ongoing: (\r\n            <Timer callStartedTime={callStartedTime} callState={callState} />\r\n          ),\r\n          reconnecting: \"Reconnecting. . .\",\r\n          connectionLost: (\r\n            <span>\r\n              <Timer callStartedTime={callStartedTime} callState={callState} />\r\n              {\"\\tConnection Lost!\"}\r\n            </span>\r\n          ),\r\n          hangup: (\r\n            <span>\r\n              <Timer callStartedTime={callStartedTime} callState={callState} />\r\n              {\"\\tcall Ended!\"}\r\n            </span>\r\n          ),\r\n        }[callState]\r\n      }\r\n    </Typography>\r\n  );\r\n}\r\n\r\nfunction MicButton({ disabled, muted, setMuted }) {\r\n  const theme = useTheme();\r\n  const classes = useButtonStyles();\r\n  return (\r\n    <IconButton\r\n      className={classes.button}\r\n      disabled={disabled}\r\n      onClick={() => {\r\n        setMuted(!muted);\r\n      }}\r\n    >\r\n      {muted ? (\r\n        <MicOff htmlColor={theme.palette.grey[500]} />\r\n      ) : (\r\n        <Mic htmlColor={theme.palette.grey[500]} />\r\n      )}\r\n    </IconButton>\r\n  );\r\n}\r\n\r\nfunction RecallButton({ callType, callingUser }) {\r\n  const theme = useTheme();\r\n  const classes = useButtonStyles();\r\n  return (\r\n    <IconButton\r\n      className={classes.button_incoming}\r\n      onClick={() => {\r\n        const call = new CustomEvent(\"call\", {\r\n          detail: { callingUser, callType },\r\n        });\r\n        document.dispatchEvent(call);\r\n      }}\r\n    >\r\n      <Call htmlColor={theme.palette.success.main} />\r\n    </IconButton>\r\n  );\r\n}\r\nfunction AcceptCallButton({ callType }) {\r\n  const theme = useTheme();\r\n  const classes = useButtonStyles();\r\n  return (\r\n    <IconButton\r\n      className={classes.button_incoming}\r\n      onClick={() => {\r\n        const callAccepted = new CustomEvent(\"callAccepted\");\r\n        document.dispatchEvent(callAccepted);\r\n      }}\r\n    >\r\n      {\r\n        {\r\n          AudioCall: <Call htmlColor={theme.palette.success.main} />,\r\n          VideoCall: <VideoCall htmlColor={theme.palette.success.main} />,\r\n        }[callType]\r\n      }\r\n    </IconButton>\r\n  );\r\n}\r\n\r\nfunction EndCallButton() {\r\n  const theme = useTheme();\r\n  const classes = useButtonStyles();\r\n  return (\r\n    <IconButton\r\n      className={classes.button}\r\n      onClick={() => {\r\n        const callEnd = new CustomEvent(\"callEnd\");\r\n        document.dispatchEvent(callEnd);\r\n      }}\r\n    >\r\n      <CallEnd htmlColor={theme.palette.error.main} />\r\n    </IconButton>\r\n  );\r\n}\r\n\r\nfunction ActionButtons({ callType, callState, callingUser, muted, setMuted }) {\r\n  switch (true) {\r\n    case [\r\n      CALLSTATES.CONNECTING,\r\n      CALLSTATES.CONNECTED,\r\n      CALLSTATES.CALLING,\r\n      CALLSTATES.ONGOING,\r\n      CALLSTATES.RECONNECTING,\r\n    ].some((state) => state === callState):\r\n      return (\r\n        <>\r\n          <MicButton\r\n            disabled={callState !== CALLSTATES.ONGOING}\r\n            muted={muted}\r\n            setMuted={setMuted}\r\n          />\r\n          <EndCallButton />\r\n        </>\r\n      );\r\n\r\n    case [\r\n      CALLSTATES.CALLFAILED,\r\n      CALLSTATES.NOANSWER,\r\n      CALLSTATES.BUSY,\r\n      CALLSTATES.CONNECTIONLOST,\r\n    ].some((state) => state === callState):\r\n      return <RecallButton callType={callType} callingUser={callingUser} />;\r\n\r\n    case callState === CALLSTATES.RINGING:\r\n      return (\r\n        <>\r\n          <AcceptCallButton callType={callType} />\r\n          <EndCallButton />\r\n        </>\r\n      );\r\n    default:\r\n      return null;\r\n  }\r\n}\r\n\r\nfunction CallAlert({\r\n  direction,\r\n  callType,\r\n  callState,\r\n  callingUser,\r\n  remoteStream,\r\n  localStream,\r\n  callStartedTime,\r\n}) {\r\n  const classes = useStyles();\r\n  //refs\r\n  const alertRef = createRef(null);\r\n  const audioRef = useRef();\r\n  //states\r\n  const [muted, setMuted] = useState(false);\r\n\r\n  // call Sounds\r\n  useCallSounds(callState);\r\n\r\n  useEffect(() => {\r\n    if (localStream) {\r\n      localStream.getAudioTracks().forEach((track) => (track.enabled = !muted)); //toggle mic\r\n    }\r\n  }, [muted, localStream]);\r\n\r\n  useEffect(() => {\r\n    if (remoteStream) {\r\n      audioRef.current.srcObject = remoteStream;\r\n      audioRef.current.play();\r\n    }\r\n  }, [remoteStream]);\r\n\r\n  return (\r\n    <Slide direction=\"down\" in={true} timeout={{ enter: 200, exit: 500 }}>\r\n      <Box className={classes.call_alert} boxShadow={5} ref={alertRef}>\r\n        {remoteStream && <audio ref={audioRef} autoPlay={true} />}\r\n\r\n        {/* <CallSounds callState={callState} /> */}\r\n\r\n        <div className={classes.call_animation}>\r\n          <Avatar\r\n            className={classes.avatar}\r\n            src={callingUser.profilePic}\r\n            alt=\"user\"\r\n          />\r\n        </div>\r\n\r\n        <Box\r\n          mx=\"1em\"\r\n          style={{\r\n            //makes text unselectable\r\n            WebkitUserSelect: \"none\" /* Chrome all / Safari all */,\r\n            MozUserSelect: \"none\" /* Firefox all */,\r\n            msUserSelect: \"none\" /* IE 10+ */,\r\n            userSelect: \"none\",\r\n          }}\r\n        >\r\n          <CallStatus callState={callState} callStartedTime={callStartedTime} />\r\n\r\n          <Typography color=\"textPrimary\" style={{ fontSize: \"1.1em\" }}>\r\n            {callingUser.firstName} {callingUser.lastName}\r\n          </Typography>\r\n        </Box>\r\n\r\n        <ActionButtons\r\n          callState={callState}\r\n          callType={callType}\r\n          direction={direction}\r\n          muted={muted}\r\n          setMuted={setMuted}\r\n        />\r\n      </Box>\r\n    </Slide>\r\n  );\r\n}\r\n\r\nexport default CallAlert;\r\n","import { Box, IconButton, makeStyles } from \"@material-ui/core\";\r\nimport {\r\n  CallEnd,\r\n  Mic,\r\n  MicOff,\r\n  Videocam,\r\n  VideocamOff,\r\n} from \"@material-ui/icons\";\r\nimport React, { useRef } from \"react\";\r\n\r\nconst useStyles = makeStyles({\r\n  root: {\r\n    position: \"absolute\",\r\n    top: \"100%\",\r\n    transform: \"translateY(-100%)\",\r\n    marginTop: \"-2em\",\r\n  },\r\n  actionBtn: {\r\n    height: \"2.5em\",\r\n    width: \"2.5em\",\r\n    margin: \"0 0.8em\",\r\n    \"&:nth-child(1),&:nth-child(2)\": {\r\n      backgroundColor: \"#7c7c7c62\",\r\n      backdropFilter: \"blur(5px)\",\r\n      webkitBackdropFilter: \"blur(5px)\",\r\n    },\r\n    \"&:last-child\": {\r\n      backgroundColor: \"#ff0000\",\r\n      backdropFilter: \"blur(5px)\",\r\n      webkitBackdropFilter: \"blur(5px)\",\r\n    },\r\n  },\r\n});\r\n\r\nfunction ActionButtons({ muted, cameraEnabled, setMuted, setCameraEnabled }) {\r\n  const classes = useStyles();\r\n  const callEndRef = useRef(new Event(\"callEnd\"));\r\n\r\n  function endCall() {\r\n    const callEnd = callEndRef.current;\r\n    document.dispatchEvent(callEnd);\r\n  }\r\n\r\n  return (\r\n    <Box className={classes.root}>\r\n      <Box className={classes.ActionButtons}>\r\n        <IconButton\r\n          className={classes.actionBtn}\r\n          onClick={() => {\r\n            setCameraEnabled(!cameraEnabled);\r\n          }}\r\n        >\r\n          {cameraEnabled ? (\r\n            <Videocam htmlColor=\"white\" />\r\n          ) : (\r\n            <VideocamOff htmlColor=\"white\" />\r\n          )}\r\n        </IconButton>\r\n        <IconButton\r\n          className={classes.actionBtn}\r\n          onClick={() => {\r\n            setMuted(!muted);\r\n          }}\r\n        >\r\n          {muted ? <MicOff htmlColor=\"white\" /> : <Mic htmlColor=\"white\" />}\r\n        </IconButton>\r\n        <IconButton className={classes.actionBtn} onClick={endCall}>\r\n          <CallEnd htmlColor=\"white\" />\r\n        </IconButton>\r\n      </Box>\r\n    </Box>\r\n  );\r\n}\r\n\r\nexport default ActionButtons;\r\n","import {\r\n  Avatar,\r\n  Box,\r\n  IconButton,\r\n  makeStyles,\r\n  Typography,\r\n} from \"@material-ui/core\";\r\nimport { Fullscreen, FullscreenExit } from \"@material-ui/icons\";\r\nimport React, { useState } from \"react\";\r\nimport { CALLSTATES } from \".\";\r\nimport Timer from \"./CallTimer\";\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  videoCallHeader: {\r\n    position: \"absolute\",\r\n    zIndex: \"1000\",\r\n    backgroundColor: \"#7c7c7c62\",\r\n    backdropFilter: \"blur(5px)\",\r\n    webkitBackdropFilter: \"blur(5px)\",\r\n    width: \"100%\",\r\n    padding: \"0.8em\",\r\n    alignSelf: \"stretch\",\r\n    display: \"flex\",\r\n    justifyContent: \"space-between\",\r\n  },\r\n  userInfoContainer: {\r\n    display: \"flex\",\r\n    alignItems: \"center\",\r\n    margin: \"0 0.5em\",\r\n  },\r\n  headerBtn: {\r\n    margin: \"0 0.5em\",\r\n  },\r\n  wrapper: {\r\n    color: \"#fff\",\r\n    marginLeft: \"1em\",\r\n  },\r\n  timer: {\r\n    color: theme.palette.grey[300],\r\n  },\r\n  avatar: {\r\n    height: \"2.3em\",\r\n    width: \"2.3em\",\r\n  },\r\n}));\r\n\r\nfunction VideoCallHeader({ callState, callingUser, callStartedTime }) {\r\n  const classes = useStyles();\r\n\r\n  const [fullScreen, setFullScreen] = useState(false);\r\n\r\n  function toggleFullScreen() {\r\n    if (!document.fullscreenElement) {\r\n      document.documentElement.requestFullscreen();\r\n      setFullScreen(true);\r\n    } else {\r\n      if (document.exitFullscreen) {\r\n        document.exitFullscreen();\r\n        setFullScreen(false);\r\n      }\r\n    }\r\n  }\r\n\r\n  return (\r\n    <Box className={classes.videoCallHeader}>\r\n      <Box className={classes.userInfoContainer}>\r\n        <Avatar className={classes.avatar} src={callingUser.profilePic} />\r\n        <Box className={classes.wrapper}>\r\n          <Typography variant=\"h6\" className={classes.username}>\r\n            {callingUser.firstName} {callingUser.lastName}\r\n          </Typography>\r\n          {callState === CALLSTATES.ONGOING && (\r\n            <Typography variant=\"subtitle2\" className={classes.timer}>\r\n              <Timer callStartedTime={callStartedTime} callState={callState} />\r\n            </Typography>\r\n          )}\r\n        </Box>\r\n      </Box>\r\n      <Box className={classes.headerBtnsContainer}>\r\n        <IconButton className={classes.headerBtn} onClick={toggleFullScreen}>\r\n          {fullScreen ? (\r\n            <FullscreenExit htmlColor=\"white\" />\r\n          ) : (\r\n            <Fullscreen htmlColor=\"white\" />\r\n          )}\r\n        </IconButton>\r\n      </Box>\r\n    </Box>\r\n  );\r\n}\r\n\r\nexport default VideoCallHeader;\r\n","import { Box, makeStyles } from \"@material-ui/core\";\r\nimport React from \"react\";\r\n\r\nconst useStyles = makeStyles({\r\n  videoContainer: {\r\n    height: \"100%\",\r\n    width: \"100%\",\r\n    \"&>video\": {\r\n      width: \"100%\",\r\n      height: \"100%\",\r\n      objectFit: \"contain\",\r\n    },\r\n  },\r\n  localVideoContainer: {\r\n    position: \"absolute\",\r\n    height: \"20vh\",\r\n    top: \"6em\",\r\n    right: \"1em\",\r\n    backgroundColor: \"white\",\r\n    \"&>video\": {\r\n      height: \"100%\",\r\n      width: \"100%\",\r\n      objectFit: \"contain\",\r\n    },\r\n  },\r\n});\r\n\r\nfunction VideoContainer({ localVideo, remoteVideo }) {\r\n  const classes = useStyles();\r\n  return (\r\n    <Box className={classes.videoContainer}>\r\n      <Box className={classes.localVideoContainer}>\r\n        <video ref={localVideo} autoPlay={true} muted={true} />\r\n      </Box>\r\n      <video ref={remoteVideo} autoPlay={true} />\r\n    </Box>\r\n  );\r\n}\r\n\r\nexport default VideoContainer;\r\n","import { Box, makeStyles } from \"@material-ui/core\";\r\nimport React, { useEffect, useRef, useState } from \"react\";\r\nimport ActionButtons from \"./ActionButtons\";\r\nimport VideoCallHeader from \"./VideoCallHeader\";\r\nimport VideoContainer from \"./VideoContainer\";\r\n\r\nconst useStyles = makeStyles({\r\n  root: {\r\n    position: \"absolute\",\r\n    zIndex: \"1000\",\r\n    display: \"flex\",\r\n    flexDirection: \"column\",\r\n    alignItems: \"center\",\r\n    left: 0,\r\n    width: \"100%\",\r\n    height: \"100%\",\r\n    backgroundColor: \"black\",\r\n  },\r\n});\r\n\r\nfunction VideoCallScreen({\r\n  localStream,\r\n  remoteStream,\r\n  callState,\r\n  callingUser,\r\n  callStartedTime,\r\n}) {\r\n  const classes = useStyles();\r\n  const localVideo = useRef();\r\n  const remoteVideo = useRef();\r\n  const [muted, setMuted] = useState(false);\r\n  const [cameraEnabled, setCameraEnabled] = useState(true);\r\n\r\n  useEffect(() => {\r\n    remoteVideo.current.srcObject = remoteStream;\r\n    localVideo.current.srcObject = localStream;\r\n  }, [remoteStream, localStream]);\r\n\r\n  useEffect(() => {\r\n    function toggleMic() {\r\n      localStream.getAudioTracks().forEach((track) => (track.enabled = !muted));\r\n    }\r\n    toggleMic();\r\n  }, [muted, localStream]);\r\n\r\n  useEffect(() => {\r\n    function toggleCamera() {\r\n      localStream\r\n        .getVideoTracks()\r\n        .forEach((track) => (track.enabled = cameraEnabled));\r\n    }\r\n    toggleCamera();\r\n  }, [cameraEnabled, localStream]);\r\n\r\n  return (\r\n    <Box className={classes.root}>\r\n      <VideoCallHeader\r\n        callState={callState}\r\n        callingUser={callingUser}\r\n        callStartedTime={callStartedTime}\r\n      />\r\n      <VideoContainer localVideo={localVideo} remoteVideo={remoteVideo} />\r\n      <ActionButtons\r\n        muted={muted}\r\n        cameraEnabled={cameraEnabled}\r\n        setMuted={setMuted}\r\n        setCameraEnabled={setCameraEnabled}\r\n      />\r\n    </Box>\r\n  );\r\n}\r\n\r\nexport default VideoCallScreen;\r\n","import React, { useContext, useCallback, useEffect, useState } from \"react\";\r\nimport CallAlert from \"./CallAlert\";\r\nimport Peer from \"peerjs\";\r\nimport SocketContext from \"../../../context/SocketContext\";\r\nimport LoggedInUserContext from \"../../../context/LoggedInUserContext\";\r\nimport VideoCallScreen from \"./VideoCallScreen\";\r\n\r\nexport const CALLSTATES = {\r\n  CONNECTING: \"connecting\",\r\n  CONNECTED: \"connected\",\r\n  CALLFAILED: \"callFailed\",\r\n  CALLING: \"calling\",\r\n  RINGING: \"ringing\",\r\n  NOANSWER: \"noAnswer\",\r\n  BUSY: \"busy\",\r\n  ONGOING: \"ongoing\",\r\n  RECONNECTING: \"reconnecting\",\r\n  CONNECTIONLOST: \"connectionLost\",\r\n  HANGUP: \"hangup\",\r\n};\r\nexport const CALLDIRECTION = {\r\n  INCOMING: \"incoming\",\r\n  OUTGOING: \"outgoing\",\r\n};\r\nexport const CALLTYPE = {\r\n  AUDIOCALL: \"AudioCall\",\r\n  VIDEOCALL: \"VideoCall\",\r\n};\r\n\r\nfunction CallSection() {\r\n  const socket = useContext(SocketContext);\r\n  const { LoggedInUser } = useContext(LoggedInUserContext);\r\n  //states\r\n  const [remoteStream, setRemoteStream] = useState();\r\n  const [localStream, setLocalStream] = useState();\r\n  const [showVideoScreen, setShowVideoScreen] = useState(false);\r\n\r\n  /**\r\n   * *callStates\r\n   * callStates in outgoing call [\"connecting\",\"connected\",\"callFailed\",\"calling\",\"noAnswer\" , \"busy\" , \"ongoing\" ,\"reconnecting\", \"connectionLost\" ,\"hangup\"]\r\n   * callStates in incoming call [\"ringing\",\"ongoing\",\"reconnecting\",\"connectionLost\",\"hangup\"]\r\n   * * these callSates are in order in they occur.\r\n   */\r\n  const [callState, setCallState] = useState(); //\r\n  const [direction, setDirection] = useState();\r\n  const [callType, setCallType] = useState(); // AudioCall VideoCall\r\n  const [callingUser, setCallingUser] = useState(); //object it hold is in this shape {username,firstName,lastName,online,profilePic}\r\n  const [callStartedTime, setCallStartedTime] = useState(); // new Date();\r\n\r\n  const showCallAlert =\r\n    !(\r\n      direction === CALLDIRECTION.INCOMING &&\r\n      callState === CALLSTATES.CONNECTING\r\n    ) &&\r\n    callState &&\r\n    !showVideoScreen;\r\n\r\n  const resetStates = () => {\r\n    setShowVideoScreen(false);\r\n    setCallState();\r\n    setRemoteStream();\r\n    setLocalStream();\r\n    setDirection();\r\n    setCallType();\r\n    setCallingUser();\r\n    setCallStartedTime();\r\n  };\r\n\r\n  const call = (peer, remotePeerId, callType) => {\r\n    //call acknowledgement is received form the otherEnd.\r\n    navigator.mediaDevices\r\n      .getUserMedia({ video: callType === CALLTYPE.VIDEOCALL, audio: true })\r\n      .then((stream) => {\r\n        setLocalStream(stream);\r\n        setShowVideoScreen(callType === CALLTYPE.VIDEOCALL);\r\n        const call = peer.call(remotePeerId, stream);\r\n        setCallState(CALLSTATES.CALLING); //play calling tone in CallAlert component\r\n        call.on(\"stream\", (remoteStream) => {\r\n          //call is accepted by otherEnd\r\n          // Show stream in some <video> element if callType === videoCall\r\n          setRemoteStream(remoteStream);\r\n          setCallStartedTime(new Date()); //start call timer\r\n          setCallState(CALLSTATES.ONGOING);\r\n        });\r\n      })\r\n      .catch((err) => {\r\n        setCallState(CALLSTATES.CALLFAILED);\r\n        console.error(\"Failed to get local stream\", err);\r\n      });\r\n  };\r\n\r\n  const acceptCall = (call, callType) => {\r\n    navigator.mediaDevices\r\n      .getUserMedia({ video: callType === CALLTYPE.VIDEOCALL, audio: true })\r\n      .then((stream) => {\r\n        call.answer(stream); // Answer the call with an A/V stream.\r\n        setLocalStream(stream);\r\n        call.on(\"stream\", (remoteStream) => {\r\n          setCallStartedTime(new Date()); //start call timer\r\n          setCallState(CALLSTATES.ONGOING);\r\n          // Show stream in some <video> element.\r\n          setRemoteStream(remoteStream);\r\n          setShowVideoScreen(callType === CALLTYPE.VIDEOCALL);\r\n        });\r\n      })\r\n      .catch((err) => {\r\n        setCallState(CALLSTATES.CALLFAILED);\r\n        console.error(\"Failed to get local stream\", err);\r\n      });\r\n  };\r\n\r\n  const handleCall = useCallback(\r\n    (e) => {\r\n      const callDirection = e.detail\r\n        ? CALLDIRECTION.OUTGOING\r\n        : CALLDIRECTION.INCOMING;\r\n      const callType = e.detail?.callType || e.callType;\r\n      setDirection(callDirection);\r\n      setCallingUser(e.detail?.userInfo || e.caller);\r\n      setCallType(callType);\r\n      setCallState(CALLSTATES.CONNECTING); //show CallAlert component\r\n\r\n      const peer = new Peer(); //creating new peer\r\n      peer.on(\"open\", function (peerId) {\r\n        if (callDirection === CALLDIRECTION.OUTGOING) {\r\n          const userInfo = e.detail.userInfo; //this person\r\n          socket.emit(\"outgoingCall\", peerId, userInfo, callType);\r\n          socket.on(\r\n            \"acknowledgedCall\",\r\n            (remotePeerId, caller, receiver, ackCallType) => {\r\n              if (\r\n                caller.username === LoggedInUser.username &&\r\n                receiver === userInfo.username &&\r\n                ackCallType === callType\r\n              ) {\r\n                setCallState(CALLSTATES.CONNECTED); //play call connected sound in CallAlert component\r\n                call(peer, remotePeerId, callType);\r\n              }\r\n            }\r\n          );\r\n        } else {\r\n          setCallType(e.callType);\r\n          setCallState(CALLSTATES.RINGING); //play ringtone\r\n          socket.emit(\r\n            \"callAcknowledged\",\r\n            peerId,\r\n            e.caller,\r\n            LoggedInUser.username,\r\n            e.callType\r\n          );\r\n        }\r\n      });\r\n\r\n      function callHandler(call) {\r\n        setCallState(CALLSTATES.RINGING); //play ringtone\r\n        document.addEventListener(\"callAccepted\", () => {\r\n          acceptCall(call, callType);\r\n        });\r\n      }\r\n      //answer call\r\n      peer.on(\"call\", callHandler);\r\n    },\r\n    [socket, LoggedInUser]\r\n  );\r\n\r\n  //stopping the mic and camera streams.\r\n  const stopStreams = useCallback(() => {\r\n    remoteStream?.getTracks().forEach((tracks) => tracks.stop());\r\n    localStream?.getTracks().forEach((tracks) => tracks.stop());\r\n  }, [remoteStream, localStream]);\r\n\r\n  const endCall = useCallback(\r\n    function () {\r\n      if (this !== socket) {\r\n        callState === CALLSTATES.RINGING\r\n          ? socket.emit(\"callRejected\", callingUser)\r\n          : socket.emit(\"callEnd\", callingUser);\r\n      } //if it is called by socket.on() no need to emit. This happens when otherEnd ends the call. So no need to tell otherEnd the call has ended.\r\n      setCallState(CALLSTATES.HANGUP);\r\n      stopStreams();\r\n      setTimeout(resetStates, 2000); //wait 2 sec before everything is clear so callEnd sound and callended info can be shown.\r\n    },\r\n    [socket, callingUser, callState, stopStreams]\r\n  );\r\n\r\n  useEffect(() => {\r\n    switch (callState) {\r\n      //for callFailed\r\n      case CALLSTATES.CONNECTING:\r\n        var callFailTimeOut = setTimeout(() => {\r\n          setCallState(CALLSTATES.CALLFAILED);\r\n          setTimeout(resetStates, 3000);\r\n        }, 10000);\r\n        break;\r\n\r\n      //for noAnswer\r\n      case CALLSTATES.RINGING:\r\n        var noAnswerTimeOut = setTimeout(() => {\r\n          socket.emit(\"noAnswer\", callingUser);\r\n          resetStates();\r\n        }, 10000);\r\n        break;\r\n      case CALLSTATES.NOANSWER:\r\n      case CALLSTATES.BUSY:\r\n        setTimeout(resetStates, 3000);\r\n        stopStreams();\r\n        break;\r\n\r\n      default:\r\n        break;\r\n    }\r\n\r\n    return () => {\r\n      clearTimeout(callFailTimeOut);\r\n      clearTimeout(noAnswerTimeOut);\r\n    };\r\n  }, [socket, callState, callingUser, stopStreams]);\r\n\r\n  useEffect(() => {\r\n    socket.on(\"incomingCall\", handleCall);\r\n    socket.on(\"callEnd\", endCall);\r\n    socket.on(\"noAnswer\", () => {\r\n      setCallState(CALLSTATES.NOANSWER);\r\n    });\r\n    socket.on(\"callRejected\", () => {\r\n      setCallState(CALLSTATES.BUSY);\r\n    });\r\n    socket.on(\"userBusy\", (busyUser) => {\r\n      callingUser === busyUser && setCallState(CALLSTATES.BUSY);\r\n    });\r\n\r\n    document.addEventListener(\"call\", handleCall);\r\n    document.addEventListener(\"callEnd\", endCall);\r\n    return () => {\r\n      document.removeEventListener(\"call\", handleCall);\r\n      document.removeEventListener(\"callEnd\", endCall);\r\n      socket.off(\"incomingCall\", handleCall);\r\n      socket.off(\"callEnd\", endCall);\r\n    };\r\n  }, [socket, callingUser, handleCall, endCall]);\r\n\r\n  return (\r\n    <>\r\n      {showCallAlert && (\r\n        <CallAlert\r\n          direction={direction}\r\n          callType={callType}\r\n          callingUser={callingUser}\r\n          callState={callState}\r\n          callStartedTime={callStartedTime}\r\n          //AudioCall is handled in this component\r\n          remoteStream={remoteStream}\r\n          localStream={localStream}\r\n        />\r\n      )}\r\n\r\n      {showVideoScreen && (\r\n        <VideoCallScreen\r\n          localStream={localStream}\r\n          remoteStream={remoteStream}\r\n          callState={callState}\r\n          callingUser={callingUser}\r\n          callStartedTime={callStartedTime}\r\n        />\r\n      )}\r\n    </>\r\n  );\r\n}\r\n\r\nexport default CallSection;\r\n","import { Box, useMediaQuery, useTheme } from \"@material-ui/core\";\r\nimport React, { useEffect, useState } from \"react\";\r\nimport { io } from \"socket.io-client\";\r\nimport ChatSection from \"./ChatSection/index\";\r\nimport SideNavigation from \"./SideNavigation/index\";\r\nimport ChangeProfilePicture from \"./ChangeProfilePicture\";\r\nimport config from \"../../backendConfig\";\r\nimport SocketContext from \"../../context/SocketContext\";\r\nimport LoggedInUserContext from \"../../context/LoggedInUserContext\";\r\nimport { Route } from \"react-router\";\r\nimport CallSection from \"./CallSection\";\r\n\r\nfunction MessengerPage({ user }) {\r\n  //setting up socket\r\n  const socket = io(config.wsAddress, {\r\n    auth: { token: localStorage.getItem(\"accesstoken\") },\r\n  });\r\n\r\n  const theme = useTheme();\r\n  const [showChangeProfilePicture, setShowChangeProfilePicture] =\r\n    useState(false);\r\n\r\n  const notMediumScreen = useMediaQuery(theme.breakpoints.down(\"sm\"));\r\n\r\n  useEffect(() => {\r\n    socket.on(\"connect\", () => {\r\n      console.log(\"socket connected\");\r\n    });\r\n\r\n    socket.on(\"disconnect\", () => {\r\n      console.log(\"socket disconnected!\");\r\n    });\r\n\r\n    //clean up\r\n    return () => {\r\n      socket.disconnect();\r\n    };\r\n  }, [socket]);\r\n\r\n  const [LoggedInUser, setLoggedInUser] = useState(user);\r\n  const value = { LoggedInUser, setLoggedInUser };\r\n  return (\r\n    <SocketContext.Provider value={socket}>\r\n      <LoggedInUserContext.Provider value={value}>\r\n        <Box\r\n          display=\"flex\"\r\n          minHeight={\"100vh\"}\r\n          position=\"relative\"\r\n          bgcolor={theme.palette.background.default}\r\n        >\r\n          {user.newUser ? <ChangeProfilePicture greeting /> : null}\r\n\r\n          {showChangeProfilePicture ? (\r\n            <ChangeProfilePicture\r\n              setShowChangeProfilePicture={setShowChangeProfilePicture}\r\n            />\r\n          ) : null}\r\n\r\n          {notMediumScreen ? (\r\n            <>\r\n              <Route path=\"/messenger\" exact>\r\n                <SideNavigation\r\n                  setShowChangeProfilePicture={setShowChangeProfilePicture}\r\n                />\r\n              </Route>\r\n              <Route path=\"/messenger/:username\" exact>\r\n                <ChatSection />\r\n              </Route>\r\n            </>\r\n          ) : (\r\n            <>\r\n              <SideNavigation\r\n                setShowChangeProfilePicture={setShowChangeProfilePicture}\r\n              />\r\n              <Route path=\"/messenger/:username?\">\r\n                <ChatSection />\r\n              </Route>\r\n            </>\r\n          )}\r\n\r\n          <CallSection />\r\n        </Box>\r\n      </LoggedInUserContext.Provider>\r\n    </SocketContext.Provider>\r\n  );\r\n}\r\nexport default MessengerPage;\r\n","import { useEffect, useState } from \"react\";\r\nimport { Redirect } from \"react-router-dom\";\r\nimport MessengerPage from \"../MessengerPage\";\r\nimport authenticateLoginToken from \"./authenticateUser\";\r\n\r\nfunction ProtectedRoute({ children }) {\r\n  const [loggedIn, setLoggedIn] = useState(false);\r\n  const [checked, setChecked] = useState(false);\r\n  const [error, setError] = useState(\"\");\r\n\r\n  useEffect(() => {\r\n    (async () => {\r\n      try {\r\n        const valid = await authenticateLoginToken();\r\n        setLoggedIn(valid);//vaid object contains loggein in user \r\n        setChecked(true);\r\n      } catch (err) {\r\n        setError(err.response?.data || err.message);\r\n      }\r\n    })();\r\n  }, []);\r\n\r\n  if (error) {\r\n    return (\r\n      <Redirect\r\n        to={{\r\n          pathname: \"/login\",\r\n          state: { alert: { type: \"error\", message: error } },\r\n        }}\r\n      />\r\n    );\r\n  }\r\n\r\n  if (checked && loggedIn) {\r\n    return <MessengerPage user={loggedIn.user} />;\r\n  }\r\n  if (checked && !loggedIn) {\r\n    return <Redirect to=\"/login\" />;\r\n  }\r\n  return null;\r\n}\r\n\r\nexport default ProtectedRoute;\r\n","import { createMuiTheme } from \"@material-ui/core\";\r\nimport { ThemeProvider } from \"@material-ui/styles\";\r\nimport React from \"react\";\r\nimport { BrowserRouter, Route, Switch } from \"react-router-dom\";\r\nimport LoginPage from \"./components/LoginPage\";\r\nimport MessengerPage from \"./components/MessengerPage\";\r\nimport ProtectedRoute from \"./components/ProtectedRoute\";\r\n\r\nconst theme = createMuiTheme({\r\n  palette: {\r\n    type: \"light\",\r\n    primary: {\r\n      main: \"#00ab55\",\r\n    },\r\n    background: {\r\n      paper: \"#fff\",\r\n      default: \"#fff\",\r\n    },\r\n  },\r\n  breakpoints: {\r\n    values: {\r\n      xs: 0,\r\n      sm: 600,\r\n      md: 900,\r\n      lg: 1280,\r\n      xl: 1920,\r\n    },\r\n  },\r\n});\r\n\r\nexport default function App() {\r\n  return (\r\n    <BrowserRouter>\r\n      <ThemeProvider theme={theme}>\r\n        <Switch>\r\n          <Route path={[\"/\", \"/login\", \"/signup\"]}>\r\n            <LoginPage />\r\n          </Route>\r\n          <Route path=\"/messenger\">\r\n            <ProtectedRoute>\r\n              <MessengerPage />\r\n            </ProtectedRoute>\r\n          </Route>\r\n        </Switch>\r\n      </ThemeProvider>\r\n    </BrowserRouter>\r\n  );\r\n}\r\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n"],"sourceRoot":""}